

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Server &mdash; open62541 1.1.0-rc1-52-g9a543201f-dirty documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Client" href="client.html" />
    <link rel="prev" title="Information Modelling" href="nodestore.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="toc.html" class="icon icon-home"> open62541
          

          
            
            <img src="_static/open62541_html.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="building.html">Building open62541</a></li>
<li class="toctree-l1"><a class="reference internal" href="installing.html">Installing open62541</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="protocol.html">Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="types.html">Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="services.html">Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="nodestore.html">Information Modelling</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Server</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#server-configuration">Server Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#server-lifecycle">Server Lifecycle</a></li>
<li class="toctree-l2"><a class="reference internal" href="#timed-callbacks">Timed Callbacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reading-and-writing-node-attributes">Reading and Writing Node Attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#browsing">Browsing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#discovery">Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="#information-model-callbacks">Information Model Callbacks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#node-lifecycle-constructors-destructors-and-node-contexts">Node Lifecycle: Constructors, Destructors and Node Contexts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-source-callback">Data Source Callback</a></li>
<li class="toctree-l3"><a class="reference internal" href="#value-callback">Value Callback</a></li>
<li class="toctree-l3"><a class="reference internal" href="#local-monitoreditems">Local MonitoredItems</a></li>
<li class="toctree-l3"><a class="reference internal" href="#method-callbacks">Method Callbacks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#interacting-with-objects">Interacting with Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="#node-addition-and-deletion">Node Addition and Deletion</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reference-management">Reference Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="#events">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="#utility-functions">Utility Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#async-operations">Async Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#statistics">Statistics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="client.html">Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="common.html">Common Definitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="nodeset_compiler.html">XML Nodeset Compiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="internal.html">Internals</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="toc.html">open62541</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="toc.html">Docs</a> &raquo;</li>
        
      <li>Server</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/server.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="server">
<span id="id1"></span><h1>Server<a class="headerlink" href="#server" title="Permalink to this headline">¶</a></h1>
<div class="section" id="server-configuration">
<span id="id2"></span><h2>Server Configuration<a class="headerlink" href="#server-configuration" title="Permalink to this headline">¶</a></h2>
<p>The configuration structure is passed to the server during initialization.
The server expects that the configuration is not modified during runtime.
Currently, only one server can use a configuration at a time. During
shutdown, the server will clean up the parts of the configuration that are
modified at runtime through the provided API.</p>
<p>Examples for configurations are provided in the <code class="docutils literal notranslate"><span class="pre">/plugins</span></code> folder.
The usual usage is as follows:</p>
<ol class="arabic simple">
<li><p>Create a server configuration with default settings as a starting point</p></li>
<li><p>Modifiy the configuration, e.g. by adding a server certificate</p></li>
<li><p>Instantiate a server with it</p></li>
<li><p>After shutdown of the server, clean up the configuration (free memory)</p></li>
</ol>
<p>The <a class="reference internal" href="tutorials.html#tutorials"><span class="std std-ref">Tutorials</span></a> provide a good starting point for this.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">UA_UInt32</span> <span class="n">min</span><span class="p">;</span>
    <span class="n">UA_UInt32</span> <span class="n">max</span><span class="p">;</span>
<span class="p">}</span> <span class="n">UA_UInt32Range</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">UA_Duration</span> <span class="n">min</span><span class="p">;</span>
    <span class="n">UA_Duration</span> <span class="n">max</span><span class="p">;</span>
<span class="p">}</span> <span class="n">UA_DurationRange</span><span class="p">;</span>

<span class="cp">#ifdef UA_ENABLE_DISCOVERY</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>

    <span class="cm">/* Timeout in seconds when to automatically remove a registered server from</span>
<span class="cm">     * the list, if it doesn&#39;t re-register within the given time frame. A value</span>
<span class="cm">     * of 0 disables automatic removal. Default is 60 Minutes (60*60). Must be</span>
<span class="cm">     * bigger than 10 seconds, because cleanup is only triggered approximately</span>
<span class="cm">     * every 10 seconds. The server will still be removed depending on the</span>
<span class="cm">     * state of the semaphore file. */</span>
    <span class="n">UA_UInt32</span> <span class="n">cleanupTimeout</span><span class="p">;</span>

    <span class="cm">/* Enable mDNS announce and response to queries */</span>
    <span class="kt">bool</span> <span class="n">mdnsEnable</span><span class="p">;</span>

<span class="cp">#ifdef UA_ENABLE_DISCOVERY_MULTICAST</span>
    <span class="n">UA_MdnsDiscoveryConfiguration</span> <span class="n">mdns</span><span class="p">;</span>
    <span class="n">UA_String</span> <span class="n">mdnsInterfaceIP</span><span class="p">;</span>
<span class="cp"># if !defined(UA_HAS_GETIFADDR)</span>
    <span class="kt">uint32_t</span> <span class="o">*</span><span class="n">ipAddressList</span><span class="p">;</span>
    <span class="kt">size_t</span> <span class="n">ipAddressListSize</span><span class="p">;</span>
<span class="cp"># endif</span>
<span class="cp">#endif</span>

<span class="p">}</span> <span class="n">UA_ServerConfig_Discovery</span><span class="p">;</span>

<span class="cp">#endif</span>

<span class="k">typedef</span> <span class="nf">void</span>
<span class="p">(</span><span class="o">*</span><span class="n">UA_Server_AsyncOperationNotifyCallback</span><span class="p">)(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">UA_ServerConfig</span> <span class="p">{</span>
    <span class="n">UA_UInt16</span> <span class="n">nThreads</span><span class="p">;</span> <span class="cm">/* only if multithreading is enabled */</span>
    <span class="n">UA_Logger</span> <span class="n">logger</span><span class="p">;</span>

    <span class="cm">/* Server Description:</span>
<span class="cm">     * The description must be internally consistent.</span>
<span class="cm">     * - The ApplicationUri set in the ApplicationDescription must match the</span>
<span class="cm">     *   URI set in the server certificate */</span>
    <span class="n">UA_BuildInfo</span> <span class="n">buildInfo</span><span class="p">;</span>
    <span class="n">UA_ApplicationDescription</span> <span class="n">applicationDescription</span><span class="p">;</span>
    <span class="n">UA_ByteString</span> <span class="n">serverCertificate</span><span class="p">;</span>

    <span class="n">UA_Double</span> <span class="n">shutdownDelay</span><span class="p">;</span> <span class="cm">/* Delay in ms from the shutdown signal (ctrl-c)</span>
<span class="cm">                                until the actual shutdown. Clients need to be</span>
<span class="cm">                                able to get a notification ahead of time. */</span>

    <span class="cm">/* Rule Handling */</span>
    <span class="n">UA_RuleHandling</span> <span class="n">verifyRequestTimestamp</span><span class="p">;</span> <span class="cm">/* Verify that the server sends a</span>
<span class="cm">                                             * timestamp in the request header */</span>

    <span class="cm">/* Custom DataTypes. Attention! Custom datatypes are not cleaned up together</span>
<span class="cm">     * with the configuration. So it is possible to allocate them on ROM. */</span>
    <span class="k">const</span> <span class="n">UA_DataTypeArray</span> <span class="o">*</span><span class="n">customDataTypes</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See the section on <a class="reference internal" href="types.html#generic-types"><span class="std std-ref">Generic Type Handling</span></a>. Examples for working
with custom data types are provided in
<code class="docutils literal notranslate"><span class="pre">/examples/custom_datatype/</span></code>.</p>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span>    <span class="cm">/* Networking */</span>
    <span class="kt">size_t</span> <span class="n">networkLayersSize</span><span class="p">;</span>
    <span class="n">UA_ServerNetworkLayer</span> <span class="o">*</span><span class="n">networkLayers</span><span class="p">;</span>
    <span class="n">UA_String</span> <span class="n">customHostname</span><span class="p">;</span>

<span class="cp">#ifdef UA_ENABLE_PUBSUB</span>
    <span class="cm">/*PubSub network layer */</span>
    <span class="kt">size_t</span> <span class="n">pubsubTransportLayersSize</span><span class="p">;</span>
    <span class="n">UA_PubSubTransportLayer</span> <span class="o">*</span><span class="n">pubsubTransportLayers</span><span class="p">;</span>
<span class="cp">#endif</span>

    <span class="cm">/* Available security policies */</span>
    <span class="kt">size_t</span> <span class="n">securityPoliciesSize</span><span class="p">;</span>
    <span class="n">UA_SecurityPolicy</span><span class="o">*</span> <span class="n">securityPolicies</span><span class="p">;</span>

    <span class="cm">/* Available endpoints */</span>
    <span class="kt">size_t</span> <span class="n">endpointsSize</span><span class="p">;</span>
    <span class="n">UA_EndpointDescription</span> <span class="o">*</span><span class="n">endpoints</span><span class="p">;</span>

    <span class="cm">/* Only allow the following discovery services to be executed on a</span>
<span class="cm">     * SecureChannel with SecurityPolicyNone: GetEndpointsRequest,</span>
<span class="cm">     * FindServersRequest and FindServersOnNetworkRequest.</span>
<span class="cm">     *</span>
<span class="cm">     * Only enable this option if there is no endpoint with SecurityPolicy#None</span>
<span class="cm">     * in the endpoints list. The SecurityPolicy#None must be present in the</span>
<span class="cm">     * securityPolicies list. */</span>
    <span class="n">UA_Boolean</span> <span class="n">securityPolicyNoneDiscoveryOnly</span><span class="p">;</span>

    <span class="cm">/* Node Lifecycle callbacks */</span>
    <span class="n">UA_GlobalNodeLifecycle</span> <span class="n">nodeLifecycle</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See the section for <a class="reference internal" href="#node-lifecycle"><span class="std std-ref">node lifecycle
handling</span></a>.</p>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Access Control */</span>
<span class="n">UA_AccessControl</span> <span class="n">accessControl</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See the section for <a class="reference internal" href="plugin_accesscontrol.html#access-control"><span class="std std-ref">access-control
handling</span></a>.</p>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span>    <span class="cm">/* Async Operations */</span>
<span class="cp">#if UA_MULTITHREADING &gt;= 100</span>
    <span class="n">UA_Double</span> <span class="n">asyncOperationTimeout</span><span class="p">;</span> <span class="cm">/* in ms, 0 =&gt; unlimited */</span>
    <span class="kt">size_t</span> <span class="n">maxAsyncOperationQueueSize</span><span class="p">;</span> <span class="cm">/* 0 =&gt; unlimited */</span>
    <span class="n">UA_DEPRECATED</span> <span class="n">UA_Double</span> <span class="n">asyncCallRequestTimeout</span><span class="p">;</span> <span class="cm">/* in ms, 0 =&gt; unlimited */</span>
    <span class="cm">/* Notify workers when an async operation was enqueued */</span>
    <span class="n">UA_Server_AsyncOperationNotifyCallback</span> <span class="n">asyncOperationNotifyCallback</span><span class="p">;</span>
<span class="cp">#endif</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See the section for <a class="reference internal" href="#async-operations"><span class="std std-ref">async
operations</span></a>.</p>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span>    <span class="cm">/* Nodestore */</span>
    <span class="n">UA_Nodestore</span> <span class="n">nodestore</span><span class="p">;</span>

    <span class="cm">/* Certificate Verification */</span>
    <span class="n">UA_CertificateVerification</span> <span class="n">certificateVerification</span><span class="p">;</span>

    <span class="cm">/* Relax constraints for the InformationModel */</span>
    <span class="n">UA_Boolean</span> <span class="n">relaxEmptyValueConstraint</span><span class="p">;</span> <span class="cm">/* Nominally, only variables with data</span>
<span class="cm">                                           * type BaseDataType can have an empty</span>
<span class="cm">                                           * value. */</span>

    <span class="cm">/* Limits for SecureChannels */</span>
    <span class="n">UA_UInt16</span> <span class="n">maxSecureChannels</span><span class="p">;</span>
    <span class="n">UA_UInt32</span> <span class="n">maxSecurityTokenLifetime</span><span class="p">;</span> <span class="cm">/* in ms */</span>

    <span class="cm">/* Limits for Sessions */</span>
    <span class="n">UA_UInt16</span> <span class="n">maxSessions</span><span class="p">;</span>
    <span class="n">UA_Double</span> <span class="n">maxSessionTimeout</span><span class="p">;</span> <span class="cm">/* in ms */</span>

    <span class="cm">/* Operation limits */</span>
    <span class="n">UA_UInt32</span> <span class="n">maxNodesPerRead</span><span class="p">;</span>
    <span class="n">UA_UInt32</span> <span class="n">maxNodesPerWrite</span><span class="p">;</span>
    <span class="n">UA_UInt32</span> <span class="n">maxNodesPerMethodCall</span><span class="p">;</span>
    <span class="n">UA_UInt32</span> <span class="n">maxNodesPerBrowse</span><span class="p">;</span>
    <span class="n">UA_UInt32</span> <span class="n">maxNodesPerRegisterNodes</span><span class="p">;</span>
    <span class="n">UA_UInt32</span> <span class="n">maxNodesPerTranslateBrowsePathsToNodeIds</span><span class="p">;</span>
    <span class="n">UA_UInt32</span> <span class="n">maxNodesPerNodeManagement</span><span class="p">;</span>
    <span class="n">UA_UInt32</span> <span class="n">maxMonitoredItemsPerCall</span><span class="p">;</span>

    <span class="cm">/* Limits for Requests */</span>
    <span class="n">UA_UInt32</span> <span class="n">maxReferencesPerNode</span><span class="p">;</span>

    <span class="cm">/* Limits for Subscriptions */</span>
    <span class="n">UA_UInt32</span> <span class="n">maxSubscriptions</span><span class="p">;</span>
    <span class="n">UA_UInt32</span> <span class="n">maxSubscriptionsPerSession</span><span class="p">;</span>
    <span class="n">UA_DurationRange</span> <span class="n">publishingIntervalLimits</span><span class="p">;</span> <span class="cm">/* in ms (must not be less than 5) */</span>
    <span class="n">UA_UInt32Range</span> <span class="n">lifeTimeCountLimits</span><span class="p">;</span>
    <span class="n">UA_UInt32Range</span> <span class="n">keepAliveCountLimits</span><span class="p">;</span>
    <span class="n">UA_UInt32</span> <span class="n">maxNotificationsPerPublish</span><span class="p">;</span>
    <span class="n">UA_Boolean</span> <span class="n">enableRetransmissionQueue</span><span class="p">;</span>
    <span class="n">UA_UInt32</span> <span class="n">maxRetransmissionQueueSize</span><span class="p">;</span> <span class="cm">/* 0 -&gt; unlimited size */</span>
<span class="cp">#ifdef UA_ENABLE_SUBSCRIPTIONS_EVENTS</span>
    <span class="n">UA_UInt32</span> <span class="n">maxEventsPerNode</span><span class="p">;</span> <span class="cm">/* 0 -&gt; unlimited size */</span>
<span class="cp">#endif</span>

    <span class="cm">/* Limits for MonitoredItems */</span>
    <span class="n">UA_UInt32</span> <span class="n">maxMonitoredItems</span><span class="p">;</span>
    <span class="n">UA_UInt32</span> <span class="n">maxMonitoredItemsPerSubscription</span><span class="p">;</span>
    <span class="n">UA_DurationRange</span> <span class="n">samplingIntervalLimits</span><span class="p">;</span> <span class="cm">/* in ms (must not be less than 5) */</span>
    <span class="n">UA_UInt32Range</span> <span class="n">queueSizeLimits</span><span class="p">;</span> <span class="cm">/* Negotiated with the client */</span>

    <span class="cm">/* Limits for PublishRequests */</span>
    <span class="n">UA_UInt32</span> <span class="n">maxPublishReqPerSession</span><span class="p">;</span>

    <span class="cm">/* Discovery */</span>
<span class="cp">#ifdef UA_ENABLE_DISCOVERY</span>
    <span class="n">UA_ServerConfig_Discovery</span> <span class="n">discovery</span><span class="p">;</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef UA_ENABLE_SUBSCRIPTIONS</span>
    <span class="cm">/* Register MonitoredItem in Userland</span>
<span class="cm">     *</span>
<span class="cm">     * @param server Allows the access to the server object</span>
<span class="cm">     * @param sessionId The session id, represented as an node id</span>
<span class="cm">     * @param sessionContext An optional pointer to user-defined data for the specific data source</span>
<span class="cm">     * @param nodeid Id of the node in question</span>
<span class="cm">     * @param nodeidContext An optional pointer to user-defined data, associated</span>
<span class="cm">     *        with the node in the nodestore. Note that, if the node has already been removed,</span>
<span class="cm">     *        this value contains a NULL pointer.</span>
<span class="cm">     * @param attributeId Identifies which attribute (value, data type etc.) is monitored</span>
<span class="cm">     * @param removed Determines if the MonitoredItem was removed or created. */</span>
    <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">monitoredItemRegisterCallback</span><span class="p">)(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span>
                                          <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">sessionId</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">sessionContext</span><span class="p">,</span>
                                          <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">nodeId</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span>
                                          <span class="n">UA_UInt32</span> <span class="n">attibuteId</span><span class="p">,</span> <span class="n">UA_Boolean</span> <span class="n">removed</span><span class="p">);</span>
<span class="cp">#endif</span>

    <span class="cm">/* Historical Access */</span>
<span class="cp">#ifdef UA_ENABLE_HISTORIZING</span>
    <span class="n">UA_HistoryDatabase</span> <span class="n">historyDatabase</span><span class="p">;</span>

    <span class="n">UA_Boolean</span> <span class="n">accessHistoryDataCapability</span><span class="p">;</span>
    <span class="n">UA_UInt32</span>  <span class="n">maxReturnDataValues</span><span class="p">;</span> <span class="cm">/* 0 -&gt; unlimited size */</span>

    <span class="n">UA_Boolean</span> <span class="n">accessHistoryEventsCapability</span><span class="p">;</span>
    <span class="n">UA_UInt32</span>  <span class="n">maxReturnEventValues</span><span class="p">;</span> <span class="cm">/* 0 -&gt; unlimited size */</span>

    <span class="n">UA_Boolean</span> <span class="n">insertDataCapability</span><span class="p">;</span>
    <span class="n">UA_Boolean</span> <span class="n">insertEventCapability</span><span class="p">;</span>
    <span class="n">UA_Boolean</span> <span class="n">insertAnnotationsCapability</span><span class="p">;</span>

    <span class="n">UA_Boolean</span> <span class="n">replaceDataCapability</span><span class="p">;</span>
    <span class="n">UA_Boolean</span> <span class="n">replaceEventCapability</span><span class="p">;</span>

    <span class="n">UA_Boolean</span> <span class="n">updateDataCapability</span><span class="p">;</span>
    <span class="n">UA_Boolean</span> <span class="n">updateEventCapability</span><span class="p">;</span>

    <span class="n">UA_Boolean</span> <span class="n">deleteRawCapability</span><span class="p">;</span>
    <span class="n">UA_Boolean</span> <span class="n">deleteEventCapability</span><span class="p">;</span>
    <span class="n">UA_Boolean</span> <span class="n">deleteAtTimeDataCapability</span><span class="p">;</span>
<span class="cp">#endif</span>
<span class="p">};</span>

<span class="kt">void</span>
<span class="nf">UA_ServerConfig_clean</span><span class="p">(</span><span class="n">UA_ServerConfig</span> <span class="o">*</span><span class="n">config</span><span class="p">);</span>

<span class="cm">/* Set a custom hostname in server configuration */</span>
<span class="kt">void</span>
<span class="nf">UA_ServerConfig_setCustomHostname</span><span class="p">(</span><span class="n">UA_ServerConfig</span> <span class="o">*</span><span class="n">config</span><span class="p">,</span>
                                  <span class="k">const</span> <span class="n">UA_String</span> <span class="n">customHostname</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="server-lifecycle">
<span id="id3"></span><h2>Server Lifecycle<a class="headerlink" href="#server-lifecycle" title="Permalink to this headline">¶</a></h2>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* The method UA_Server_new is defined in server_config_default.h. So default</span>
<span class="cm"> * plugins outside of the core library (for logging, etc) are already available</span>
<span class="cm"> * during the initialization.</span>
<span class="cm"> *</span>
<span class="cm"> * UA_Server * UA_Server_new(void);</span>
<span class="cm"> */</span>

<span class="cm">/* Creates a new server. Moves the config into the server with a shallow copy.</span>
<span class="cm"> * The config content is cleared together with the server. */</span>
<span class="n">UA_Server</span> <span class="o">*</span>
<span class="nf">UA_Server_newWithConfig</span><span class="p">(</span><span class="k">const</span> <span class="n">UA_ServerConfig</span> <span class="o">*</span><span class="n">config</span><span class="p">);</span>

<span class="kt">void</span> <span class="nf">UA_Server_delete</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">);</span>

<span class="n">UA_ServerConfig</span> <span class="o">*</span>
<span class="nf">UA_Server_getConfig</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">);</span>

<span class="cm">/* Runs the main loop of the server. In each iteration, this calls into the</span>
<span class="cm"> * networklayers to see if messages have arrived.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object.</span>
<span class="cm"> * @param running The loop is run as long as *running is true.</span>
<span class="cm"> *        Otherwise, the server shuts down.</span>
<span class="cm"> * @return Returns the statuscode of the UA_Server_run_shutdown method */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_run</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="k">volatile</span> <span class="n">UA_Boolean</span> <span class="o">*</span><span class="n">running</span><span class="p">);</span>

<span class="cm">/* The prologue part of UA_Server_run (no need to use if you call</span>
<span class="cm"> * UA_Server_run) */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_run_startup</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">);</span>

<span class="cm">/* Executes a single iteration of the server&#39;s main loop.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object.</span>
<span class="cm"> * @param waitInternal Should we wait for messages in the networklayer?</span>
<span class="cm"> *        Otherwise, the timouts for the networklayers are set to zero.</span>
<span class="cm"> *        The default max wait time is 50millisec.</span>
<span class="cm"> * @return Returns how long we can wait until the next scheduled</span>
<span class="cm"> *         callback (in ms) */</span>
<span class="n">UA_UInt16</span>
<span class="nf">UA_Server_run_iterate</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_Boolean</span> <span class="n">waitInternal</span><span class="p">);</span>

<span class="cm">/* The epilogue part of UA_Server_run (no need to use if you call</span>
<span class="cm"> * UA_Server_run) */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_run_shutdown</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="timed-callbacks">
<h2>Timed Callbacks<a class="headerlink" href="#timed-callbacks" title="Permalink to this headline">¶</a></h2>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="nf">void</span> <span class="p">(</span><span class="o">*</span><span class="n">UA_ServerCallback</span><span class="p">)(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">);</span>

<span class="cm">/* Add a callback for execution at a specified time. If the indicated time lies</span>
<span class="cm"> * in the past, then the callback is executed at the next iteration of the</span>
<span class="cm"> * server&#39;s main loop.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object.</span>
<span class="cm"> * @param callback The callback that shall be added.</span>
<span class="cm"> * @param data Data that is forwarded to the callback.</span>
<span class="cm"> * @param date The timestamp for the execution time.</span>
<span class="cm"> * @param callbackId Set to the identifier of the repeated callback . This can</span>
<span class="cm"> *        be used to cancel the callback later on. If the pointer is null, the</span>
<span class="cm"> *        identifier is not set.</span>
<span class="cm"> * @return Upon success, UA_STATUSCODE_GOOD is returned. An error code</span>
<span class="cm"> *         otherwise. */</span>
<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_addTimedCallback</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_ServerCallback</span> <span class="n">callback</span><span class="p">,</span>
                           <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="n">UA_DateTime</span> <span class="n">date</span><span class="p">,</span> <span class="n">UA_UInt64</span> <span class="o">*</span><span class="n">callbackId</span><span class="p">);</span>

<span class="cm">/* Add a callback for cyclic repetition to the server.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object.</span>
<span class="cm"> * @param callback The callback that shall be added.</span>
<span class="cm"> * @param data Data that is forwarded to the callback.</span>
<span class="cm"> * @param interval_ms The callback shall be repeatedly executed with the given</span>
<span class="cm"> *        interval (in ms). The interval must be positive. The first execution</span>
<span class="cm"> *        occurs at now() + interval at the latest.</span>
<span class="cm"> * @param callbackId Set to the identifier of the repeated callback . This can</span>
<span class="cm"> *        be used to cancel the callback later on. If the pointer is null, the</span>
<span class="cm"> *        identifier is not set.</span>
<span class="cm"> * @return Upon success, UA_STATUSCODE_GOOD is returned. An error code</span>
<span class="cm"> *         otherwise. */</span>
<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_addRepeatedCallback</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_ServerCallback</span> <span class="n">callback</span><span class="p">,</span>
                              <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="n">UA_Double</span> <span class="n">interval_ms</span><span class="p">,</span> <span class="n">UA_UInt64</span> <span class="o">*</span><span class="n">callbackId</span><span class="p">);</span>

<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_changeRepeatedCallbackInterval</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_UInt64</span> <span class="n">callbackId</span><span class="p">,</span>
                                         <span class="n">UA_Double</span> <span class="n">interval_ms</span><span class="p">);</span>

<span class="cm">/* Remove a repeated callback. Does nothing if the callback is not found.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object.</span>
<span class="cm"> * @param callbackId The id of the callback */</span>
<span class="kt">void</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_removeCallback</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_UInt64</span> <span class="n">callbackId</span><span class="p">);</span>

<span class="cp">#define UA_Server_removeRepeatedCallback(server, callbackId) \</span>
<span class="cp">    UA_Server_removeCallback(server, callbackId);</span>
</pre></div>
</div>
</div>
<div class="section" id="reading-and-writing-node-attributes">
<h2>Reading and Writing Node Attributes<a class="headerlink" href="#reading-and-writing-node-attributes" title="Permalink to this headline">¶</a></h2>
<p>The functions for reading and writing node attributes call the regular read
and write service in the background that are also used over the network.</p>
<p>The following attributes cannot be read, since the local “admin” user always
has full rights.</p>
<ul class="simple">
<li><p>UserWriteMask</p></li>
<li><p>UserAccessLevel</p></li>
<li><p>UserExecutable</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Read an attribute of a node. The specialized functions below provide a more</span>
<span class="cm"> * concise syntax.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object.</span>
<span class="cm"> * @param item ReadValueIds contain the NodeId of the target node, the id of the</span>
<span class="cm"> *             attribute to read and (optionally) an index range to read parts</span>
<span class="cm"> *             of an array only. See the section on NumericRange for the format</span>
<span class="cm"> *             used for array ranges.</span>
<span class="cm"> * @param timestamps Which timestamps to return for the attribute.</span>
<span class="cm"> * @return Returns a DataValue that contains either an error code, or a variant</span>
<span class="cm"> *         with the attribute value and the timestamps. */</span>
<span class="n">UA_DataValue</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_read</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_ReadValueId</span> <span class="o">*</span><span class="n">item</span><span class="p">,</span>
               <span class="n">UA_TimestampsToReturn</span> <span class="n">timestamps</span><span class="p">);</span>

<span class="cm">/* Don&#39;t use this function. There are typed versions for every supported</span>
<span class="cm"> * attribute. */</span>
<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">__UA_Server_read</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">nodeId</span><span class="p">,</span>
                 <span class="n">UA_AttributeId</span> <span class="n">attributeId</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">v</span><span class="p">);</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_readNodeId</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                     <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">outNodeId</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_NODEID</span><span class="p">,</span> <span class="n">outNodeId</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_readNodeClass</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                        <span class="n">UA_NodeClass</span> <span class="o">*</span><span class="n">outNodeClass</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_NODECLASS</span><span class="p">,</span>
                            <span class="n">outNodeClass</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_readBrowseName</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                         <span class="n">UA_QualifiedName</span> <span class="o">*</span><span class="n">outBrowseName</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_BROWSENAME</span><span class="p">,</span>
                            <span class="n">outBrowseName</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_readDisplayName</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                          <span class="n">UA_LocalizedText</span> <span class="o">*</span><span class="n">outDisplayName</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_DISPLAYNAME</span><span class="p">,</span>
                            <span class="n">outDisplayName</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_readDescription</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                          <span class="n">UA_LocalizedText</span> <span class="o">*</span><span class="n">outDescription</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_DESCRIPTION</span><span class="p">,</span>
                            <span class="n">outDescription</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_readWriteMask</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                        <span class="n">UA_UInt32</span> <span class="o">*</span><span class="n">outWriteMask</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_WRITEMASK</span><span class="p">,</span>
                            <span class="n">outWriteMask</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_readIsAbstract</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                         <span class="n">UA_Boolean</span> <span class="o">*</span><span class="n">outIsAbstract</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_ISABSTRACT</span><span class="p">,</span>
                            <span class="n">outIsAbstract</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_readSymmetric</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                        <span class="n">UA_Boolean</span> <span class="o">*</span><span class="n">outSymmetric</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_SYMMETRIC</span><span class="p">,</span>
                            <span class="n">outSymmetric</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_readInverseName</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                          <span class="n">UA_LocalizedText</span> <span class="o">*</span><span class="n">outInverseName</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_INVERSENAME</span><span class="p">,</span>
                            <span class="n">outInverseName</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_readContainsNoLoops</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                              <span class="n">UA_Boolean</span> <span class="o">*</span><span class="n">outContainsNoLoops</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_CONTAINSNOLOOPS</span><span class="p">,</span>
                            <span class="n">outContainsNoLoops</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_readEventNotifier</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                            <span class="n">UA_Byte</span> <span class="o">*</span><span class="n">outEventNotifier</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_EVENTNOTIFIER</span><span class="p">,</span>
                            <span class="n">outEventNotifier</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_readValue</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                    <span class="n">UA_Variant</span> <span class="o">*</span><span class="n">outValue</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_VALUE</span><span class="p">,</span> <span class="n">outValue</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_readDataType</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                       <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">outDataType</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_DATATYPE</span><span class="p">,</span>
                            <span class="n">outDataType</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_readValueRank</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                        <span class="n">UA_Int32</span> <span class="o">*</span><span class="n">outValueRank</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_VALUERANK</span><span class="p">,</span>
                            <span class="n">outValueRank</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* Returns a variant with an int32 array */</span>
<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_readArrayDimensions</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                              <span class="n">UA_Variant</span> <span class="o">*</span><span class="n">outArrayDimensions</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_ARRAYDIMENSIONS</span><span class="p">,</span>
                            <span class="n">outArrayDimensions</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_readAccessLevel</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                          <span class="n">UA_Byte</span> <span class="o">*</span><span class="n">outAccessLevel</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_ACCESSLEVEL</span><span class="p">,</span>
                            <span class="n">outAccessLevel</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_readMinimumSamplingInterval</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                                      <span class="n">UA_Double</span> <span class="o">*</span><span class="n">outMinimumSamplingInterval</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span>
                            <span class="n">UA_ATTRIBUTEID_MINIMUMSAMPLINGINTERVAL</span><span class="p">,</span>
                            <span class="n">outMinimumSamplingInterval</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_readHistorizing</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                          <span class="n">UA_Boolean</span> <span class="o">*</span><span class="n">outHistorizing</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_HISTORIZING</span><span class="p">,</span>
                            <span class="n">outHistorizing</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_readExecutable</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                         <span class="n">UA_Boolean</span> <span class="o">*</span><span class="n">outExecutable</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_EXECUTABLE</span><span class="p">,</span>
                            <span class="n">outExecutable</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The following node attributes cannot be changed once a node has been created:</p>
<ul class="simple">
<li><p>NodeClass</p></li>
<li><p>NodeId</p></li>
<li><p>Symmetric</p></li>
<li><p>ContainsNoLoops</p></li>
</ul>
<p>The following attributes cannot be written from the server, as they are
specific to the different users and set by the access control callback:</p>
<ul class="simple">
<li><p>UserWriteMask</p></li>
<li><p>UserAccessLevel</p></li>
<li><p>UserExecutable</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Overwrite an attribute of a node. The specialized functions below provide a</span>
<span class="cm"> * more concise syntax.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object.</span>
<span class="cm"> * @param value WriteValues contain the NodeId of the target node, the id of the</span>
<span class="cm"> *              attribute to overwritten, the actual value and (optionally) an</span>
<span class="cm"> *              index range to replace parts of an array only. of an array only.</span>
<span class="cm"> *              See the section on NumericRange for the format used for array</span>
<span class="cm"> *              ranges.</span>
<span class="cm"> * @return Returns a status code. */</span>
<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_write</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_WriteValue</span> <span class="o">*</span><span class="n">value</span><span class="p">);</span>

<span class="cm">/* Don&#39;t use this function. There are typed versions with no additional</span>
<span class="cm"> * overhead. */</span>
<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">__UA_Server_write</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">nodeId</span><span class="p">,</span>
                  <span class="k">const</span> <span class="n">UA_AttributeId</span> <span class="n">attributeId</span><span class="p">,</span>
                  <span class="k">const</span> <span class="n">UA_DataType</span> <span class="o">*</span><span class="n">attr_type</span><span class="p">,</span> <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">attr</span><span class="p">);</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_writeBrowseName</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                          <span class="k">const</span> <span class="n">UA_QualifiedName</span> <span class="n">browseName</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_BROWSENAME</span><span class="p">,</span>
                             <span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_QUALIFIEDNAME</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">browseName</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_writeDisplayName</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                           <span class="k">const</span> <span class="n">UA_LocalizedText</span> <span class="n">displayName</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_DISPLAYNAME</span><span class="p">,</span>
                             <span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_LOCALIZEDTEXT</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">displayName</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_writeDescription</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                           <span class="k">const</span> <span class="n">UA_LocalizedText</span> <span class="n">description</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_DESCRIPTION</span><span class="p">,</span>
                             <span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_LOCALIZEDTEXT</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">description</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_writeWriteMask</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                         <span class="k">const</span> <span class="n">UA_UInt32</span> <span class="n">writeMask</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_WRITEMASK</span><span class="p">,</span>
                             <span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_UINT32</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">writeMask</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_writeIsAbstract</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                          <span class="k">const</span> <span class="n">UA_Boolean</span> <span class="n">isAbstract</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_ISABSTRACT</span><span class="p">,</span>
                             <span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_BOOLEAN</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">isAbstract</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_writeInverseName</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                           <span class="k">const</span> <span class="n">UA_LocalizedText</span> <span class="n">inverseName</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_INVERSENAME</span><span class="p">,</span>
                             <span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_LOCALIZEDTEXT</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">inverseName</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_writeEventNotifier</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                             <span class="k">const</span> <span class="n">UA_Byte</span> <span class="n">eventNotifier</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_EVENTNOTIFIER</span><span class="p">,</span>
                             <span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_BYTE</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">eventNotifier</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Writes an UA_Variant to a variable/variableType node.
StatusCode is set to UA_STATUSCODE_GOOD, sourceTimestamp and
serverTimestamp are set to UA_DateTime_now()</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_writeValue</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                     <span class="k">const</span> <span class="n">UA_Variant</span> <span class="n">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_VALUE</span><span class="p">,</span>
                             <span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_VARIANT</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">value</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Writes an UA_DataValue to a variable/variableType node.
In contrast to UA_Server_writeValue, this functions can also write
sourceTimestamp, serverTimestamp and statusCode.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_writeDataValue</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                     <span class="k">const</span> <span class="n">UA_DataValue</span> <span class="n">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_VALUE</span><span class="p">,</span>
                             <span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_DATAVALUE</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">value</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_writeDataType</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                        <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">dataType</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_DATATYPE</span><span class="p">,</span>
                             <span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_NODEID</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">dataType</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_writeValueRank</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                         <span class="k">const</span> <span class="n">UA_Int32</span> <span class="n">valueRank</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_VALUERANK</span><span class="p">,</span>
                             <span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_INT32</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">valueRank</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_writeArrayDimensions</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                               <span class="k">const</span> <span class="n">UA_Variant</span> <span class="n">arrayDimensions</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_ARRAYDIMENSIONS</span><span class="p">,</span>
                             <span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_VARIANT</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">arrayDimensions</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_writeAccessLevel</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                           <span class="k">const</span> <span class="n">UA_Byte</span> <span class="n">accessLevel</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_ACCESSLEVEL</span><span class="p">,</span>
                             <span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_BYTE</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">accessLevel</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_writeMinimumSamplingInterval</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                                       <span class="k">const</span> <span class="n">UA_Double</span> <span class="n">miniumSamplingInterval</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span>
                             <span class="n">UA_ATTRIBUTEID_MINIMUMSAMPLINGINTERVAL</span><span class="p">,</span>
                             <span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_DOUBLE</span><span class="p">],</span>
                             <span class="o">&amp;</span><span class="n">miniumSamplingInterval</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_writeHistorizing</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                          <span class="k">const</span> <span class="n">UA_Boolean</span> <span class="n">historizing</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span>
                             <span class="n">UA_ATTRIBUTEID_HISTORIZING</span><span class="p">,</span>
                             <span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_BOOLEAN</span><span class="p">],</span>
                             <span class="o">&amp;</span><span class="n">historizing</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_writeExecutable</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                          <span class="k">const</span> <span class="n">UA_Boolean</span> <span class="n">executable</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">UA_ATTRIBUTEID_EXECUTABLE</span><span class="p">,</span>
                             <span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_BOOLEAN</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">executable</span><span class="p">);</span> <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="browsing">
<h2>Browsing<a class="headerlink" href="#browsing" title="Permalink to this headline">¶</a></h2>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Browse the references of a particular node. See the definition of</span>
<span class="cm"> * BrowseDescription structure for details. */</span>
<span class="n">UA_BrowseResult</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_browse</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_UInt32</span> <span class="n">maxReferences</span><span class="p">,</span>
                 <span class="k">const</span> <span class="n">UA_BrowseDescription</span> <span class="o">*</span><span class="n">bd</span><span class="p">);</span>

<span class="n">UA_BrowseResult</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_browseNext</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_Boolean</span> <span class="n">releaseContinuationPoint</span><span class="p">,</span>
                     <span class="k">const</span> <span class="n">UA_ByteString</span> <span class="o">*</span><span class="n">continuationPoint</span><span class="p">);</span>

<span class="cm">/* Nonstandard version of the browse service that recurses into child nodes.</span>
<span class="cm"> * Possible loops (that can occur for non-hierarchical references) are handled</span>
<span class="cm"> * by adding every target node at most once to the results array. */</span>
<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_browseRecursive</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_BrowseDescription</span> <span class="o">*</span><span class="n">bd</span><span class="p">,</span>
                          <span class="kt">size_t</span> <span class="o">*</span><span class="n">resultsSize</span><span class="p">,</span> <span class="n">UA_ExpandedNodeId</span> <span class="o">**</span><span class="n">results</span><span class="p">);</span>

<span class="n">UA_BrowsePathResult</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_translateBrowsePathToNodeIds</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span>
                                       <span class="k">const</span> <span class="n">UA_BrowsePath</span> <span class="o">*</span><span class="n">browsePath</span><span class="p">);</span>

<span class="cm">/* A simplified TranslateBrowsePathsToNodeIds based on the</span>
<span class="cm"> * SimpleAttributeOperand type (Part 4, 7.4.4.5).</span>
<span class="cm"> *</span>
<span class="cm"> * This specifies a relative path using a list of BrowseNames instead of the</span>
<span class="cm"> * RelativePath structure. The list of BrowseNames is equivalent to a</span>
<span class="cm"> * RelativePath that specifies forward references which are subtypes of the</span>
<span class="cm"> * HierarchicalReferences ReferenceType. All Nodes followed by the browsePath</span>
<span class="cm"> * shall be of the NodeClass Object or Variable. */</span>
<span class="n">UA_BrowsePathResult</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_browseSimplifiedBrowsePath</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">origin</span><span class="p">,</span>
                                     <span class="kt">size_t</span> <span class="n">browsePathSize</span><span class="p">,</span>
                                     <span class="k">const</span> <span class="n">UA_QualifiedName</span> <span class="o">*</span><span class="n">browsePath</span><span class="p">);</span>

<span class="cp">#ifndef HAVE_NODEITER_CALLBACK</span>
<span class="cp">#define HAVE_NODEITER_CALLBACK</span>
<span class="cm">/* Iterate over all nodes referenced by parentNodeId by calling the callback</span>
<span class="cm"> * function for each child node (in ifdef because GCC/CLANG handle include order</span>
<span class="cm"> * differently) */</span>
<span class="k">typedef</span> <span class="nf">UA_StatusCode</span>
<span class="p">(</span><span class="o">*</span><span class="n">UA_NodeIteratorCallback</span><span class="p">)(</span><span class="n">UA_NodeId</span> <span class="n">childId</span><span class="p">,</span> <span class="n">UA_Boolean</span> <span class="n">isInverse</span><span class="p">,</span>
                           <span class="n">UA_NodeId</span> <span class="n">referenceTypeId</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">handle</span><span class="p">);</span>
<span class="cp">#endif</span>

<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_forEachChildNodeCall</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_NodeId</span> <span class="n">parentNodeId</span><span class="p">,</span>
                               <span class="n">UA_NodeIteratorCallback</span> <span class="n">callback</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">handle</span><span class="p">);</span>

<span class="cp">#ifdef UA_ENABLE_DISCOVERY</span>
</pre></div>
</div>
</div>
<div class="section" id="discovery">
<h2>Discovery<a class="headerlink" href="#discovery" title="Permalink to this headline">¶</a></h2>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Register the given server instance at the discovery server.</span>
<span class="cm"> * This should be called periodically.</span>
<span class="cm"> * The semaphoreFilePath is optional. If the given file is deleted,</span>
<span class="cm"> * the server will automatically be unregistered. This could be</span>
<span class="cm"> * for example a pid file which is deleted if the server crashes.</span>
<span class="cm"> *</span>
<span class="cm"> * When the server shuts down you need to call unregister.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server</span>
<span class="cm"> * @param client the client which is used to call the RegisterServer. It must</span>
<span class="cm"> *        already be connected to the correct endpoint</span>
<span class="cm"> * @param semaphoreFilePath optional parameter pointing to semaphore file. */</span>
<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_register_discovery</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">struct</span> <span class="n">UA_Client</span> <span class="o">*</span><span class="n">client</span><span class="p">,</span>
                             <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">semaphoreFilePath</span><span class="p">);</span>

<span class="cm">/* Unregister the given server instance from the discovery server.</span>
<span class="cm"> * This should only be called when the server is shutting down.</span>
<span class="cm"> * @param server</span>
<span class="cm"> * @param client the client which is used to call the RegisterServer. It must</span>
<span class="cm"> *        already be connected to the correct endpoint */</span>
<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_unregister_discovery</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">struct</span> <span class="n">UA_Client</span> <span class="o">*</span><span class="n">client</span><span class="p">);</span>

 <span class="cm">/* Adds a periodic callback to register the server with the LDS (local discovery server)</span>
<span class="cm">  * periodically. The interval between each register call is given as second parameter.</span>
<span class="cm">  * It should be 10 minutes by default (= 10*60*1000).</span>
<span class="cm">  *</span>
<span class="cm">  * The delayFirstRegisterMs parameter indicates the delay for the first register call.</span>
<span class="cm">  * If it is 0, the first register call will be after intervalMs milliseconds,</span>
<span class="cm">  * otherwise the server&#39;s first register will be after delayFirstRegisterMs.</span>
<span class="cm">  *</span>
<span class="cm">  * When you manually unregister the server, you also need to cancel the</span>
<span class="cm">  * periodic callback, otherwise it will be automatically be registered again.</span>
<span class="cm">  *</span>
<span class="cm">  * If you call this method multiple times for the same discoveryServerUrl, the older</span>
<span class="cm">  * periodic callback will be removed.</span>
<span class="cm">  *</span>
<span class="cm">  * @param server</span>
<span class="cm">  * @param client the client which is used to call the RegisterServer.</span>
<span class="cm">  *         It must not yet be connected and will be connected for every register call</span>
<span class="cm">  *         to the given discoveryServerUrl.</span>
<span class="cm">  * @param discoveryServerUrl where this server should register itself.</span>
<span class="cm">  *        The string will be copied internally. Therefore you can free it after calling this method.</span>
<span class="cm">  * @param intervalMs</span>
<span class="cm">  * @param delayFirstRegisterMs</span>
<span class="cm">  * @param periodicCallbackId */</span>
<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_addPeriodicServerRegisterCallback</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">struct</span> <span class="n">UA_Client</span> <span class="o">*</span><span class="n">client</span><span class="p">,</span>
                                            <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">discoveryServerUrl</span><span class="p">,</span>
                                            <span class="n">UA_Double</span> <span class="n">intervalMs</span><span class="p">,</span>
                                            <span class="n">UA_Double</span> <span class="n">delayFirstRegisterMs</span><span class="p">,</span>
                                            <span class="n">UA_UInt64</span> <span class="o">*</span><span class="n">periodicCallbackId</span><span class="p">);</span>

<span class="cm">/* Callback for RegisterServer. Data is passed from the register call */</span>
<span class="k">typedef</span> <span class="nf">void</span> <span class="p">(</span><span class="o">*</span><span class="n">UA_Server_registerServerCallback</span><span class="p">)(</span><span class="k">const</span> <span class="n">UA_RegisteredServer</span> <span class="o">*</span><span class="n">registeredServer</span><span class="p">,</span>
                                                 <span class="kt">void</span><span class="o">*</span> <span class="n">data</span><span class="p">);</span>

<span class="cm">/* Set the callback which is called if another server registeres or unregisters</span>
<span class="cm"> * with this instance. This callback is called every time the server gets a register</span>
<span class="cm"> * call. This especially means that for every periodic server register the callback will</span>
<span class="cm"> * be called.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server</span>
<span class="cm"> * @param cb the callback</span>
<span class="cm"> * @param data data passed to the callback</span>
<span class="cm"> * @return UA_STATUSCODE_SUCCESS on success */</span>
<span class="kt">void</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_setRegisterServerCallback</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_Server_registerServerCallback</span> <span class="n">cb</span><span class="p">,</span>
                                    <span class="kt">void</span><span class="o">*</span> <span class="n">data</span><span class="p">);</span>

<span class="cp">#ifdef UA_ENABLE_DISCOVERY_MULTICAST</span>

<span class="cm">/* Callback for server detected through mDNS. Data is passed from the register</span>
<span class="cm"> * call</span>
<span class="cm"> *</span>
<span class="cm"> * @param isServerAnnounce indicates if the server has just been detected. If</span>
<span class="cm"> *        set to false, this means the server is shutting down.</span>
<span class="cm"> * @param isTxtReceived indicates if we already received the corresponding TXT</span>
<span class="cm"> *        record with the path and caps data */</span>
<span class="k">typedef</span> <span class="nf">void</span> <span class="p">(</span><span class="o">*</span><span class="n">UA_Server_serverOnNetworkCallback</span><span class="p">)(</span><span class="k">const</span> <span class="n">UA_ServerOnNetwork</span> <span class="o">*</span><span class="n">serverOnNetwork</span><span class="p">,</span>
                                                  <span class="n">UA_Boolean</span> <span class="n">isServerAnnounce</span><span class="p">,</span>
                                                  <span class="n">UA_Boolean</span> <span class="n">isTxtReceived</span><span class="p">,</span> <span class="kt">void</span><span class="o">*</span> <span class="n">data</span><span class="p">);</span>

<span class="cm">/* Set the callback which is called if another server is found through mDNS or</span>
<span class="cm"> * deleted. It will be called for any mDNS message from the remote server, thus</span>
<span class="cm"> * it may be called multiple times for the same instance. Also the SRV and TXT</span>
<span class="cm"> * records may arrive later, therefore for the first call the server</span>
<span class="cm"> * capabilities may not be set yet. If called multiple times, previous data will</span>
<span class="cm"> * be overwritten.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server</span>
<span class="cm"> * @param cb the callback</span>
<span class="cm"> * @param data data passed to the callback</span>
<span class="cm"> * @return UA_STATUSCODE_SUCCESS on success */</span>
<span class="kt">void</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_setServerOnNetworkCallback</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span>
                                     <span class="n">UA_Server_serverOnNetworkCallback</span> <span class="n">cb</span><span class="p">,</span>
                                     <span class="kt">void</span><span class="o">*</span> <span class="n">data</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* UA_ENABLE_DISCOVERY_MULTICAST */</span><span class="cp"></span>

<span class="cp">#endif </span><span class="cm">/* UA_ENABLE_DISCOVERY */</span><span class="cp"></span>
</pre></div>
</div>
</div>
<div class="section" id="information-model-callbacks">
<h2>Information Model Callbacks<a class="headerlink" href="#information-model-callbacks" title="Permalink to this headline">¶</a></h2>
<p>There are three places where a callback from an information model to
user-defined code can happen.</p>
<ul class="simple">
<li><p>Custom node constructors and destructors</p></li>
<li><p>Linking VariableNodes with an external data source</p></li>
<li><p>MethodNode callbacks</p></li>
</ul>
<div class="section" id="node-lifecycle-constructors-destructors-and-node-contexts">
<span id="node-lifecycle"></span><h3>Node Lifecycle: Constructors, Destructors and Node Contexts<a class="headerlink" href="#node-lifecycle-constructors-destructors-and-node-contexts" title="Permalink to this headline">¶</a></h3>
<p>To finalize the instantiation of a node, a (user-defined) constructor
callback is executed. There can be both a global constructor for all nodes
and node-type constructor specific to the TypeDefinition of the new node
(attached to an ObjectTypeNode or VariableTypeNode).</p>
<p>In the hierarchy of ObjectTypes and VariableTypes, only the constructor of
the (lowest) type defined for the new node is executed. Note that every
Object and Variable can have only one <code class="docutils literal notranslate"><span class="pre">isTypeOf</span></code> reference. But type-nodes
can technically have several <code class="docutils literal notranslate"><span class="pre">hasSubType</span></code> references to implement multiple
inheritance. Issues of (multiple) inheritance in the constructor need to be
solved by the user.</p>
<p>When a node is destroyed, the node-type destructor is called before the
global destructor. So the overall node lifecycle is as follows:</p>
<ol class="arabic simple">
<li><p>Global Constructor (set in the server config)</p></li>
<li><p>Node-Type Constructor (for VariableType or ObjectTypes)</p></li>
<li><p>(Usage-period of the Node)</p></li>
<li><p>Node-Type Destructor</p></li>
<li><p>Global Destructor</p></li>
</ol>
<p>The constructor and destructor callbacks can be set to <code class="docutils literal notranslate"><span class="pre">NULL</span></code> and are not
used in that case. If the node-type constructor fails, the global destructor
will be called before removing the node. The destructors are assumed to never
fail.</p>
<p>Every node carries a user-context and a constructor-context pointer. The
user-context is used to attach custom data to a node. But the (user-defined)
constructors and destructors may replace the user-context pointer if they
wish to do so. The initial value for the constructor-context is <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.
When the <code class="docutils literal notranslate"><span class="pre">AddNodes</span></code> service is used over the network, the user-context
pointer of the new node is also initially set to <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* To be set in the server config. */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="cm">/* Can be NULL. May replace the nodeContext */</span>
    <span class="n">UA_StatusCode</span> <span class="p">(</span><span class="o">*</span><span class="n">constructor</span><span class="p">)(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span>
                                 <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">sessionId</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">sessionContext</span><span class="p">,</span>
                                 <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">nodeId</span><span class="p">,</span> <span class="kt">void</span> <span class="o">**</span><span class="n">nodeContext</span><span class="p">);</span>

    <span class="cm">/* Can be NULL. The context cannot be replaced since the node is destroyed</span>
<span class="cm">     * immediately afterwards anyway. */</span>
    <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">destructor</span><span class="p">)(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span>
                       <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">sessionId</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">sessionContext</span><span class="p">,</span>
                       <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">nodeId</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">nodeContext</span><span class="p">);</span>

    <span class="cm">/* Can be NULL. Called during recursive node instantiation. While mandatory</span>
<span class="cm">     * child nodes are automatically created if not already present, optional child</span>
<span class="cm">     * nodes are not. This callback can be used to define whether an optional child</span>
<span class="cm">     * node should be created.</span>
<span class="cm">     *</span>
<span class="cm">     * @param server The server executing the callback</span>
<span class="cm">     * @param sessionId The identifier of the session</span>
<span class="cm">     * @param sessionContext Additional data attached to the session in the</span>
<span class="cm">     *        access control layer</span>
<span class="cm">     * @param sourceNodeId Source node from the type definition. If the new node</span>
<span class="cm">     *        shall be created, it will be a copy of this node.</span>
<span class="cm">     * @param targetParentNodeId Parent of the potential new child node</span>
<span class="cm">     * @param referenceTypeId Identifies the reference type which that the parent</span>
<span class="cm">     *        node has to the new node.</span>
<span class="cm">     * @return Return UA_TRUE if the child node shall be instantiatet,</span>
<span class="cm">     *         UA_FALSE otherwise. */</span>
    <span class="n">UA_Boolean</span> <span class="p">(</span><span class="o">*</span><span class="n">createOptionalChild</span><span class="p">)(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span>
                                      <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">sessionId</span><span class="p">,</span>
                                      <span class="kt">void</span> <span class="o">*</span><span class="n">sessionContext</span><span class="p">,</span>
                                      <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">sourceNodeId</span><span class="p">,</span>
                                      <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">targetParentNodeId</span><span class="p">,</span>
                                      <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">referenceTypeId</span><span class="p">);</span>

    <span class="cm">/* Can be NULL. Called when a node is to be copied during recursive</span>
<span class="cm">     * node instantiation. Allows definition of the NodeId for the new node.</span>
<span class="cm">     * If the callback is set to NULL or the resulting NodeId is UA_NODEID_NULL,</span>
<span class="cm">     * then a random NodeId will be generated.</span>
<span class="cm">     *</span>
<span class="cm">     * @param server The server executing the callback</span>
<span class="cm">     * @param sessionId The identifier of the session</span>
<span class="cm">     * @param sessionContext Additional data attached to the session in the</span>
<span class="cm">     *        access control layer</span>
<span class="cm">     * @param sourceNodeId Source node of the copy operation</span>
<span class="cm">     * @param targetParentNodeId Parent node of the new node</span>
<span class="cm">     * @param referenceTypeId Identifies the reference type which that the parent</span>
<span class="cm">     *        node has to the new node. */</span>
    <span class="n">UA_StatusCode</span> <span class="p">(</span><span class="o">*</span><span class="n">generateChildNodeId</span><span class="p">)(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span>
                                         <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">sessionId</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">sessionContext</span><span class="p">,</span>
                                         <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">sourceNodeId</span><span class="p">,</span>
                                         <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">targetParentNodeId</span><span class="p">,</span>
                                         <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">referenceTypeId</span><span class="p">,</span>
                                         <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">targetNodeId</span><span class="p">);</span>
    <span class="p">}</span> <span class="n">UA_GlobalNodeLifecycle</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="cm">/* Can be NULL. May replace the nodeContext */</span>
    <span class="n">UA_StatusCode</span> <span class="p">(</span><span class="o">*</span><span class="n">constructor</span><span class="p">)(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span>
                                 <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">sessionId</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">sessionContext</span><span class="p">,</span>
                                 <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">typeNodeId</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">typeNodeContext</span><span class="p">,</span>
                                 <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">nodeId</span><span class="p">,</span> <span class="kt">void</span> <span class="o">**</span><span class="n">nodeContext</span><span class="p">);</span>

    <span class="cm">/* Can be NULL. May replace the nodeContext. */</span>
    <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">destructor</span><span class="p">)(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span>
                       <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">sessionId</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">sessionContext</span><span class="p">,</span>
                       <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">typeNodeId</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">typeNodeContext</span><span class="p">,</span>
                       <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">nodeId</span><span class="p">,</span> <span class="kt">void</span> <span class="o">**</span><span class="n">nodeContext</span><span class="p">);</span>
<span class="p">}</span> <span class="n">UA_NodeTypeLifecycle</span><span class="p">;</span>

<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_setNodeTypeLifecycle</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                               <span class="n">UA_NodeTypeLifecycle</span> <span class="n">lifecycle</span><span class="p">);</span>

<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_getNodeContext</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                         <span class="kt">void</span> <span class="o">**</span><span class="n">nodeContext</span><span class="p">);</span>

<span class="cm">/* Careful! The user has to ensure that the destructor callbacks still work. */</span>
<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_setNodeContext</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                         <span class="kt">void</span> <span class="o">*</span><span class="n">nodeContext</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="data-source-callback">
<span id="datasource"></span><h3>Data Source Callback<a class="headerlink" href="#data-source-callback" title="Permalink to this headline">¶</a></h3>
<p>The server has a unique way of dealing with the content of variables. Instead
of storing a variant attached to the variable node, the node can point to a
function with a local data provider. Whenever the value attribute is read,
the function will be called and asked to provide a UA_DataValue return value
that contains the value content and additional timestamps.</p>
<p>It is expected that the read callback is implemented. The write callback can
be set to a null-pointer.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="cm">/* Copies the data from the source into the provided value.</span>
<span class="cm">     *</span>
<span class="cm">     * !! ZERO-COPY OPERATIONS POSSIBLE !!</span>
<span class="cm">     * It is not required to return a copy of the actual content data. You can</span>
<span class="cm">     * return a pointer to memory owned by the user. Memory can be reused</span>
<span class="cm">     * between read callbacks of a DataSource, as the result is already encoded</span>
<span class="cm">     * on the network buffer between each read operation.</span>
<span class="cm">     *</span>
<span class="cm">     * To use zero-copy reads, set the value of the `value-&gt;value` Variant</span>
<span class="cm">     * without copying, e.g. with `UA_Variant_setScalar`. Then, also set</span>
<span class="cm">     * `value-&gt;value.storageType` to `UA_VARIANT_DATA_NODELETE` to prevent the</span>
<span class="cm">     * memory being cleaned up. Don&#39;t forget to also set `value-&gt;hasValue` to</span>
<span class="cm">     * true to indicate the presence of a value.</span>
<span class="cm">     *</span>
<span class="cm">     * @param server The server executing the callback</span>
<span class="cm">     * @param sessionId The identifier of the session</span>
<span class="cm">     * @param sessionContext Additional data attached to the session in the</span>
<span class="cm">     *        access control layer</span>
<span class="cm">     * @param nodeId The identifier of the node being read from</span>
<span class="cm">     * @param nodeContext Additional data attached to the node by the user</span>
<span class="cm">     * @param includeSourceTimeStamp If true, then the datasource is expected to</span>
<span class="cm">     *        set the source timestamp in the returned value</span>
<span class="cm">     * @param range If not null, then the datasource shall return only a</span>
<span class="cm">     *        selection of the (nonscalar) data. Set</span>
<span class="cm">     *        UA_STATUSCODE_BADINDEXRANGEINVALID in the value if this does not</span>
<span class="cm">     *        apply</span>
<span class="cm">     * @param value The (non-null) DataValue that is returned to the client. The</span>
<span class="cm">     *        data source sets the read data, the result status and optionally a</span>
<span class="cm">     *        sourcetimestamp.</span>
<span class="cm">     * @return Returns a status code for logging. Error codes intended for the</span>
<span class="cm">     *         original caller are set in the value. If an error is returned,</span>
<span class="cm">     *         then no releasing of the value is done</span>
<span class="cm">     */</span>
    <span class="n">UA_StatusCode</span> <span class="p">(</span><span class="o">*</span><span class="n">read</span><span class="p">)(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">sessionId</span><span class="p">,</span>
                          <span class="kt">void</span> <span class="o">*</span><span class="n">sessionContext</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">nodeId</span><span class="p">,</span>
                          <span class="kt">void</span> <span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span> <span class="n">UA_Boolean</span> <span class="n">includeSourceTimeStamp</span><span class="p">,</span>
                          <span class="k">const</span> <span class="n">UA_NumericRange</span> <span class="o">*</span><span class="n">range</span><span class="p">,</span> <span class="n">UA_DataValue</span> <span class="o">*</span><span class="n">value</span><span class="p">);</span>

    <span class="cm">/* Write into a data source. This method pointer can be NULL if the</span>
<span class="cm">     * operation is unsupported.</span>
<span class="cm">     *</span>
<span class="cm">     * @param server The server executing the callback</span>
<span class="cm">     * @param sessionId The identifier of the session</span>
<span class="cm">     * @param sessionContext Additional data attached to the session in the</span>
<span class="cm">     *        access control layer</span>
<span class="cm">     * @param nodeId The identifier of the node being written to</span>
<span class="cm">     * @param nodeContext Additional data attached to the node by the user</span>
<span class="cm">     * @param range If not NULL, then the datasource shall return only a</span>
<span class="cm">     *        selection of the (nonscalar) data. Set</span>
<span class="cm">     *        UA_STATUSCODE_BADINDEXRANGEINVALID in the value if this does not</span>
<span class="cm">     *        apply</span>
<span class="cm">     * @param value The (non-NULL) DataValue that has been written by the client.</span>
<span class="cm">     *        The data source contains the written data, the result status and</span>
<span class="cm">     *        optionally a sourcetimestamp</span>
<span class="cm">     * @return Returns a status code for logging. Error codes intended for the</span>
<span class="cm">     *         original caller are set in the value. If an error is returned,</span>
<span class="cm">     *         then no releasing of the value is done</span>
<span class="cm">     */</span>
    <span class="n">UA_StatusCode</span> <span class="p">(</span><span class="o">*</span><span class="n">write</span><span class="p">)(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">sessionId</span><span class="p">,</span>
                           <span class="kt">void</span> <span class="o">*</span><span class="n">sessionContext</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">nodeId</span><span class="p">,</span>
                           <span class="kt">void</span> <span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NumericRange</span> <span class="o">*</span><span class="n">range</span><span class="p">,</span>
                           <span class="k">const</span> <span class="n">UA_DataValue</span> <span class="o">*</span><span class="n">value</span><span class="p">);</span>
<span class="p">}</span> <span class="n">UA_DataSource</span><span class="p">;</span>

<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_setVariableNode_dataSource</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                                     <span class="k">const</span> <span class="n">UA_DataSource</span> <span class="n">dataSource</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="value-callback">
<span id="id4"></span><h3>Value Callback<a class="headerlink" href="#value-callback" title="Permalink to this headline">¶</a></h3>
<p>Value Callbacks can be attached to variable and variable type nodes. If
not <code class="docutils literal notranslate"><span class="pre">NULL</span></code>, they are called before reading and after writing respectively.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="cm">/* Called before the value attribute is read. It is possible to write into the</span>
<span class="cm">     * value attribute during onRead (using the write service). The node is</span>
<span class="cm">     * re-opened afterwards so that changes are considered in the following read</span>
<span class="cm">     * operation.</span>
<span class="cm">     *</span>
<span class="cm">     * @param handle Points to user-provided data for the callback.</span>
<span class="cm">     * @param nodeid The identifier of the node.</span>
<span class="cm">     * @param data Points to the current node value.</span>
<span class="cm">     * @param range Points to the numeric range the client wants to read from</span>
<span class="cm">     *        (or NULL). */</span>
    <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">onRead</span><span class="p">)(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">sessionId</span><span class="p">,</span>
                   <span class="kt">void</span> <span class="o">*</span><span class="n">sessionContext</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">nodeid</span><span class="p">,</span>
                   <span class="kt">void</span> <span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NumericRange</span> <span class="o">*</span><span class="n">range</span><span class="p">,</span>
                   <span class="k">const</span> <span class="n">UA_DataValue</span> <span class="o">*</span><span class="n">value</span><span class="p">);</span>

    <span class="cm">/* Called after writing the value attribute. The node is re-opened after</span>
<span class="cm">     * writing so that the new value is visible in the callback.</span>
<span class="cm">     *</span>
<span class="cm">     * @param server The server executing the callback</span>
<span class="cm">     * @sessionId The identifier of the session</span>
<span class="cm">     * @sessionContext Additional data attached to the session</span>
<span class="cm">     *                 in the access control layer</span>
<span class="cm">     * @param nodeid The identifier of the node.</span>
<span class="cm">     * @param nodeUserContext Additional data attached to the node by</span>
<span class="cm">     *        the user.</span>
<span class="cm">     * @param nodeConstructorContext Additional data attached to the node</span>
<span class="cm">     *        by the type constructor(s).</span>
<span class="cm">     * @param range Points to the numeric range the client wants to write to (or</span>
<span class="cm">     *        NULL). */</span>
    <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">onWrite</span><span class="p">)(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">sessionId</span><span class="p">,</span>
                    <span class="kt">void</span> <span class="o">*</span><span class="n">sessionContext</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">nodeId</span><span class="p">,</span>
                    <span class="kt">void</span> <span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NumericRange</span> <span class="o">*</span><span class="n">range</span><span class="p">,</span>
                    <span class="k">const</span> <span class="n">UA_DataValue</span> <span class="o">*</span><span class="n">data</span><span class="p">);</span>
<span class="p">}</span> <span class="n">UA_ValueCallback</span><span class="p">;</span>

<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_setVariableNode_valueCallback</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span>
                                        <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                                        <span class="k">const</span> <span class="n">UA_ValueCallback</span> <span class="n">callback</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="local-monitoreditems">
<span id="id5"></span><h3>Local MonitoredItems<a class="headerlink" href="#local-monitoreditems" title="Permalink to this headline">¶</a></h3>
<p>MonitoredItems are used with the Subscription mechanism of OPC UA to
transported notifications for data changes and events. MonitoredItems can
also be registered locally. Notifications are then forwarded to a
user-defined callback instead of a remote client.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifdef UA_ENABLE_SUBSCRIPTIONS</span>

<span class="k">typedef</span> <span class="nf">void</span> <span class="p">(</span><span class="o">*</span><span class="n">UA_Server_DataChangeNotificationCallback</span><span class="p">)</span>
    <span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_UInt32</span> <span class="n">monitoredItemId</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">monitoredItemContext</span><span class="p">,</span>
     <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">nodeId</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span> <span class="n">UA_UInt32</span> <span class="n">attributeId</span><span class="p">,</span>
     <span class="k">const</span> <span class="n">UA_DataValue</span> <span class="o">*</span><span class="n">value</span><span class="p">);</span>

<span class="k">typedef</span> <span class="nf">void</span> <span class="p">(</span><span class="o">*</span><span class="n">UA_Server_EventNotificationCallback</span><span class="p">)</span>
    <span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_UInt32</span> <span class="n">monId</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">monContext</span><span class="p">,</span>
     <span class="kt">size_t</span> <span class="n">nEventFields</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_Variant</span> <span class="o">*</span><span class="n">eventFields</span><span class="p">);</span>

<span class="cm">/* Create a local MonitoredItem with a sampling interval that detects data</span>
<span class="cm"> * changes.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server executing the MonitoredItem</span>
<span class="cm"> * @timestampsToReturn Shall timestamps be added to the value for the callback?</span>
<span class="cm"> * @item The parameters of the new MonitoredItem. Note that the attribute of the</span>
<span class="cm"> *       ReadValueId (the node that is monitored) can not be</span>
<span class="cm"> *       ``UA_ATTRIBUTEID_EVENTNOTIFIER``. A different callback type needs to be</span>
<span class="cm"> *       registered for event notifications.</span>
<span class="cm"> * @monitoredItemContext A pointer that is forwarded with the callback</span>
<span class="cm"> * @callback The callback that is executed on detected data changes</span>
<span class="cm"> *</span>
<span class="cm"> * @return Returns a description of the created MonitoredItem. The structure</span>
<span class="cm"> * also contains a StatusCode (in case of an error) and the identifier of the</span>
<span class="cm"> * new MonitoredItem. */</span>
<span class="n">UA_MonitoredItemCreateResult</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_createDataChangeMonitoredItem</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span>
          <span class="n">UA_TimestampsToReturn</span> <span class="n">timestampsToReturn</span><span class="p">,</span>
          <span class="k">const</span> <span class="n">UA_MonitoredItemCreateRequest</span> <span class="n">item</span><span class="p">,</span>
          <span class="kt">void</span> <span class="o">*</span><span class="n">monitoredItemContext</span><span class="p">,</span>
          <span class="n">UA_Server_DataChangeNotificationCallback</span> <span class="n">callback</span><span class="p">);</span>

<span class="cm">/* UA_MonitoredItemCreateResult */</span>
<span class="cm">/* UA_Server_createEventMonitoredItem(UA_Server *server, */</span>
<span class="cm">/*           UA_TimestampsToReturn timestampsToReturn, */</span>
<span class="cm">/*           const UA_MonitoredItemCreateRequest item, void *context, */</span>
<span class="cm">/*           UA_Server_EventNotificationCallback callback); */</span>

<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_deleteMonitoredItem</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_UInt32</span> <span class="n">monitoredItemId</span><span class="p">);</span>

<span class="cp">#endif</span>
</pre></div>
</div>
</div>
<div class="section" id="method-callbacks">
<h3>Method Callbacks<a class="headerlink" href="#method-callbacks" title="Permalink to this headline">¶</a></h3>
<p>Method callbacks are set to <cite>NULL</cite> (not executable) when a method node is
added over the network. In theory, it is possible to add a callback via
<code class="docutils literal notranslate"><span class="pre">UA_Server_setMethodNode_callback</span></code> within the global constructor when
adding methods over the network is really wanted. See the Section
<a class="reference internal" href="#object-interaction"><span class="std std-ref">Interacting with Objects</span></a> for calling methods on an object.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="nf">UA_StatusCode</span>
<span class="p">(</span><span class="o">*</span><span class="n">UA_MethodCallback</span><span class="p">)(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">sessionId</span><span class="p">,</span>
                     <span class="kt">void</span> <span class="o">*</span><span class="n">sessionContext</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">methodId</span><span class="p">,</span>
                     <span class="kt">void</span> <span class="o">*</span><span class="n">methodContext</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">objectId</span><span class="p">,</span>
                     <span class="kt">void</span> <span class="o">*</span><span class="n">objectContext</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">inputSize</span><span class="p">,</span>
                     <span class="k">const</span> <span class="n">UA_Variant</span> <span class="o">*</span><span class="n">input</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">outputSize</span><span class="p">,</span>
                     <span class="n">UA_Variant</span> <span class="o">*</span><span class="n">output</span><span class="p">);</span>

<span class="cp">#ifdef UA_ENABLE_METHODCALLS</span>
<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_setMethodNode_callback</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span>
                                 <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">methodNodeId</span><span class="p">,</span>
                                 <span class="n">UA_MethodCallback</span> <span class="n">methodCallback</span><span class="p">);</span>
<span class="cp">#endif</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="interacting-with-objects">
<span id="object-interaction"></span><h2>Interacting with Objects<a class="headerlink" href="#interacting-with-objects" title="Permalink to this headline">¶</a></h2>
<p>Objects in the information model are represented as ObjectNodes. Some
convenience functions are provided to simplify the interaction with objects.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Write an object property. The property is represented as a VariableNode with</span>
<span class="cm"> * a ``HasProperty`` reference from the ObjectNode. The VariableNode is</span>
<span class="cm"> * identified by its BrowseName. Writing the property sets the value attribute</span>
<span class="cm"> * of the VariableNode.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object</span>
<span class="cm"> * @param objectId The identifier of the object (node)</span>
<span class="cm"> * @param propertyName The name of the property</span>
<span class="cm"> * @param value The value to be set for the event attribute</span>
<span class="cm"> * @return The StatusCode for setting the event attribute */</span>
<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_writeObjectProperty</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">objectId</span><span class="p">,</span>
                              <span class="k">const</span> <span class="n">UA_QualifiedName</span> <span class="n">propertyName</span><span class="p">,</span>
                              <span class="k">const</span> <span class="n">UA_Variant</span> <span class="n">value</span><span class="p">);</span>

<span class="cm">/* Directly point to the scalar value instead of a variant */</span>
<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_writeObjectProperty_scalar</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">objectId</span><span class="p">,</span>
                                     <span class="k">const</span> <span class="n">UA_QualifiedName</span> <span class="n">propertyName</span><span class="p">,</span>
                                     <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">value</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_DataType</span> <span class="o">*</span><span class="n">type</span><span class="p">);</span>

<span class="cm">/* Read an object property.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object</span>
<span class="cm"> * @param objectId The identifier of the object (node)</span>
<span class="cm"> * @param propertyName The name of the property</span>
<span class="cm"> * @param value Contains the property value after reading. Must not be NULL.</span>
<span class="cm"> * @return The StatusCode for setting the event attribute */</span>
<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_readObjectProperty</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">objectId</span><span class="p">,</span>
                             <span class="k">const</span> <span class="n">UA_QualifiedName</span> <span class="n">propertyName</span><span class="p">,</span>
                             <span class="n">UA_Variant</span> <span class="o">*</span><span class="n">value</span><span class="p">);</span>

<span class="cp">#ifdef UA_ENABLE_METHODCALLS</span>
<span class="n">UA_CallMethodResult</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_call</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_CallMethodRequest</span> <span class="o">*</span><span class="n">request</span><span class="p">);</span>
<span class="cp">#endif</span>
</pre></div>
</div>
</div>
<div class="section" id="node-addition-and-deletion">
<span id="addnodes"></span><h2>Node Addition and Deletion<a class="headerlink" href="#node-addition-and-deletion" title="Permalink to this headline">¶</a></h2>
<p>When creating dynamic node instances at runtime, chances are that you will
not care about the specific NodeId of the new node, as long as you can
reference it later. When passing numeric NodeIds with a numeric identifier 0,
the stack evaluates this as “select a random unassigned numeric NodeId in
that namespace”. To find out which NodeId was actually assigned to the new
node, you may pass a pointer <cite>outNewNodeId</cite>, which will (after a successful
node insertion) contain the nodeId of the new node. You may also pass a
<code class="docutils literal notranslate"><span class="pre">NULL</span></code> pointer if this result is not needed.</p>
<p>See the Section <a class="reference internal" href="#node-lifecycle"><span class="std std-ref">Node Lifecycle: Constructors, Destructors and Node Contexts</span></a> on constructors and on attaching
user-defined data to nodes.</p>
<p>The methods for node addition and deletion take mostly const arguments that
are not modified. When creating a node, a deep copy of the node identifier,
node attributes, etc. is created. Therefore, it is possible to call for
example <code class="docutils literal notranslate"><span class="pre">UA_Server_addVariablenode</span></code> with a value attribute (a
<a class="reference internal" href="types.html#variant"><span class="std std-ref">Variant</span></a>) pointing to a memory location on the stack. If you need
changes to a variable value to manifest at a specific memory location, please
use a <a class="reference internal" href="#datasource"><span class="std std-ref">Data Source Callback</span></a> or a <a class="reference internal" href="#value-callback"><span class="std std-ref">Value Callback</span></a>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Protect against redundant definitions for server/client */</span>
<span class="cp">#ifndef UA_DEFAULT_ATTRIBUTES_DEFINED</span>
<span class="cp">#define UA_DEFAULT_ATTRIBUTES_DEFINED</span>
<span class="cm">/* The default for variables is &quot;BaseDataType&quot; for the datatype, -2 for the</span>
<span class="cm"> * valuerank and a read-accesslevel. */</span>
<span class="k">extern</span> <span class="k">const</span> <span class="n">UA_VariableAttributes</span> <span class="n">UA_VariableAttributes_default</span><span class="p">;</span>
<span class="k">extern</span> <span class="k">const</span> <span class="n">UA_VariableTypeAttributes</span> <span class="n">UA_VariableTypeAttributes_default</span><span class="p">;</span>
<span class="cm">/* Methods are executable by default */</span>
<span class="k">extern</span> <span class="k">const</span> <span class="n">UA_MethodAttributes</span> <span class="n">UA_MethodAttributes_default</span><span class="p">;</span>
<span class="cm">/* The remaining attribute definitions are currently all zeroed out */</span>
<span class="k">extern</span> <span class="k">const</span> <span class="n">UA_ObjectAttributes</span> <span class="n">UA_ObjectAttributes_default</span><span class="p">;</span>
<span class="k">extern</span> <span class="k">const</span> <span class="n">UA_ObjectTypeAttributes</span> <span class="n">UA_ObjectTypeAttributes_default</span><span class="p">;</span>
<span class="k">extern</span> <span class="k">const</span> <span class="n">UA_ReferenceTypeAttributes</span> <span class="n">UA_ReferenceTypeAttributes_default</span><span class="p">;</span>
<span class="k">extern</span> <span class="k">const</span> <span class="n">UA_DataTypeAttributes</span> <span class="n">UA_DataTypeAttributes_default</span><span class="p">;</span>
<span class="k">extern</span> <span class="k">const</span> <span class="n">UA_ViewAttributes</span> <span class="n">UA_ViewAttributes_default</span><span class="p">;</span>
<span class="cp">#endif</span>

<span class="cm">/* Don&#39;t use this function. There are typed versions as inline functions. */</span>
<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">__UA_Server_addNode</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeClass</span> <span class="n">nodeClass</span><span class="p">,</span>
                    <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">requestedNewNodeId</span><span class="p">,</span>
                    <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">parentNodeId</span><span class="p">,</span>
                    <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">referenceTypeId</span><span class="p">,</span>
                    <span class="k">const</span> <span class="n">UA_QualifiedName</span> <span class="n">browseName</span><span class="p">,</span>
                    <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">typeDefinition</span><span class="p">,</span>
                    <span class="k">const</span> <span class="n">UA_NodeAttributes</span> <span class="o">*</span><span class="n">attr</span><span class="p">,</span>
                    <span class="k">const</span> <span class="n">UA_DataType</span> <span class="o">*</span><span class="n">attributeType</span><span class="p">,</span>
                    <span class="kt">void</span> <span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">outNewNodeId</span><span class="p">);</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_addVariableNode</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">requestedNewNodeId</span><span class="p">,</span>
                          <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">parentNodeId</span><span class="p">,</span>
                          <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">referenceTypeId</span><span class="p">,</span>
                          <span class="k">const</span> <span class="n">UA_QualifiedName</span> <span class="n">browseName</span><span class="p">,</span>
                          <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">typeDefinition</span><span class="p">,</span>
                          <span class="k">const</span> <span class="n">UA_VariableAttributes</span> <span class="n">attr</span><span class="p">,</span>
                          <span class="kt">void</span> <span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">outNewNodeId</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_addNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_NODECLASS_VARIABLE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">requestedNewNodeId</span><span class="p">,</span>
                               <span class="o">&amp;</span><span class="n">parentNodeId</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">referenceTypeId</span><span class="p">,</span> <span class="n">browseName</span><span class="p">,</span>
                               <span class="o">&amp;</span><span class="n">typeDefinition</span><span class="p">,</span> <span class="p">(</span><span class="k">const</span> <span class="n">UA_NodeAttributes</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">attr</span><span class="p">,</span>
                               <span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_VARIABLEATTRIBUTES</span><span class="p">],</span>
                               <span class="n">nodeContext</span><span class="p">,</span> <span class="n">outNewNodeId</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_addVariableTypeNode</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span>
                              <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">requestedNewNodeId</span><span class="p">,</span>
                              <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">parentNodeId</span><span class="p">,</span>
                              <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">referenceTypeId</span><span class="p">,</span>
                              <span class="k">const</span> <span class="n">UA_QualifiedName</span> <span class="n">browseName</span><span class="p">,</span>
                              <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">typeDefinition</span><span class="p">,</span>
                              <span class="k">const</span> <span class="n">UA_VariableTypeAttributes</span> <span class="n">attr</span><span class="p">,</span>
                              <span class="kt">void</span> <span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">outNewNodeId</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_addNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_NODECLASS_VARIABLETYPE</span><span class="p">,</span>
                               <span class="o">&amp;</span><span class="n">requestedNewNodeId</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">parentNodeId</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">referenceTypeId</span><span class="p">,</span>
                               <span class="n">browseName</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">typeDefinition</span><span class="p">,</span>
                               <span class="p">(</span><span class="k">const</span> <span class="n">UA_NodeAttributes</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">attr</span><span class="p">,</span>
                               <span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_VARIABLETYPEATTRIBUTES</span><span class="p">],</span>
                               <span class="n">nodeContext</span><span class="p">,</span> <span class="n">outNewNodeId</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_addObjectNode</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">requestedNewNodeId</span><span class="p">,</span>
                        <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">parentNodeId</span><span class="p">,</span>
                        <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">referenceTypeId</span><span class="p">,</span>
                        <span class="k">const</span> <span class="n">UA_QualifiedName</span> <span class="n">browseName</span><span class="p">,</span>
                        <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">typeDefinition</span><span class="p">,</span>
                        <span class="k">const</span> <span class="n">UA_ObjectAttributes</span> <span class="n">attr</span><span class="p">,</span>
                        <span class="kt">void</span> <span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">outNewNodeId</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_addNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_NODECLASS_OBJECT</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">requestedNewNodeId</span><span class="p">,</span>
                               <span class="o">&amp;</span><span class="n">parentNodeId</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">referenceTypeId</span><span class="p">,</span> <span class="n">browseName</span><span class="p">,</span>
                               <span class="o">&amp;</span><span class="n">typeDefinition</span><span class="p">,</span> <span class="p">(</span><span class="k">const</span> <span class="n">UA_NodeAttributes</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">attr</span><span class="p">,</span>
                               <span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_OBJECTATTRIBUTES</span><span class="p">],</span>
                               <span class="n">nodeContext</span><span class="p">,</span> <span class="n">outNewNodeId</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_addObjectTypeNode</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">requestedNewNodeId</span><span class="p">,</span>
                            <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">parentNodeId</span><span class="p">,</span>
                            <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">referenceTypeId</span><span class="p">,</span>
                            <span class="k">const</span> <span class="n">UA_QualifiedName</span> <span class="n">browseName</span><span class="p">,</span>
                            <span class="k">const</span> <span class="n">UA_ObjectTypeAttributes</span> <span class="n">attr</span><span class="p">,</span>
                            <span class="kt">void</span> <span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">outNewNodeId</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_addNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_NODECLASS_OBJECTTYPE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">requestedNewNodeId</span><span class="p">,</span>
                               <span class="o">&amp;</span><span class="n">parentNodeId</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">referenceTypeId</span><span class="p">,</span> <span class="n">browseName</span><span class="p">,</span>
                               <span class="o">&amp;</span><span class="n">UA_NODEID_NULL</span><span class="p">,</span> <span class="p">(</span><span class="k">const</span> <span class="n">UA_NodeAttributes</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">attr</span><span class="p">,</span>
                               <span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_OBJECTTYPEATTRIBUTES</span><span class="p">],</span>
                               <span class="n">nodeContext</span><span class="p">,</span> <span class="n">outNewNodeId</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_addViewNode</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">requestedNewNodeId</span><span class="p">,</span>
                      <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">parentNodeId</span><span class="p">,</span>
                      <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">referenceTypeId</span><span class="p">,</span>
                      <span class="k">const</span> <span class="n">UA_QualifiedName</span> <span class="n">browseName</span><span class="p">,</span>
                      <span class="k">const</span> <span class="n">UA_ViewAttributes</span> <span class="n">attr</span><span class="p">,</span>
                      <span class="kt">void</span> <span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">outNewNodeId</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_addNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_NODECLASS_VIEW</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">requestedNewNodeId</span><span class="p">,</span>
                               <span class="o">&amp;</span><span class="n">parentNodeId</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">referenceTypeId</span><span class="p">,</span> <span class="n">browseName</span><span class="p">,</span>
                               <span class="o">&amp;</span><span class="n">UA_NODEID_NULL</span><span class="p">,</span> <span class="p">(</span><span class="k">const</span> <span class="n">UA_NodeAttributes</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">attr</span><span class="p">,</span>
                               <span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_VIEWATTRIBUTES</span><span class="p">],</span>
                               <span class="n">nodeContext</span><span class="p">,</span> <span class="n">outNewNodeId</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_addReferenceTypeNode</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span>
                               <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">requestedNewNodeId</span><span class="p">,</span>
                               <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">parentNodeId</span><span class="p">,</span>
                               <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">referenceTypeId</span><span class="p">,</span>
                               <span class="k">const</span> <span class="n">UA_QualifiedName</span> <span class="n">browseName</span><span class="p">,</span>
                               <span class="k">const</span> <span class="n">UA_ReferenceTypeAttributes</span> <span class="n">attr</span><span class="p">,</span>
                               <span class="kt">void</span> <span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">outNewNodeId</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_addNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_NODECLASS_REFERENCETYPE</span><span class="p">,</span>
                               <span class="o">&amp;</span><span class="n">requestedNewNodeId</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">parentNodeId</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">referenceTypeId</span><span class="p">,</span>
                               <span class="n">browseName</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">UA_NODEID_NULL</span><span class="p">,</span>
                               <span class="p">(</span><span class="k">const</span> <span class="n">UA_NodeAttributes</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">attr</span><span class="p">,</span>
                               <span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_REFERENCETYPEATTRIBUTES</span><span class="p">],</span>
                               <span class="n">nodeContext</span><span class="p">,</span> <span class="n">outNewNodeId</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_addDataTypeNode</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span>
                          <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">requestedNewNodeId</span><span class="p">,</span>
                          <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">parentNodeId</span><span class="p">,</span>
                          <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">referenceTypeId</span><span class="p">,</span>
                          <span class="k">const</span> <span class="n">UA_QualifiedName</span> <span class="n">browseName</span><span class="p">,</span>
                          <span class="k">const</span> <span class="n">UA_DataTypeAttributes</span> <span class="n">attr</span><span class="p">,</span>
                          <span class="kt">void</span> <span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">outNewNodeId</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">__UA_Server_addNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_NODECLASS_DATATYPE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">requestedNewNodeId</span><span class="p">,</span>
                               <span class="o">&amp;</span><span class="n">parentNodeId</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">referenceTypeId</span><span class="p">,</span> <span class="n">browseName</span><span class="p">,</span>
                               <span class="o">&amp;</span><span class="n">UA_NODEID_NULL</span><span class="p">,</span> <span class="p">(</span><span class="k">const</span> <span class="n">UA_NodeAttributes</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">attr</span><span class="p">,</span>
                               <span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_DATATYPEATTRIBUTES</span><span class="p">],</span>
                               <span class="n">nodeContext</span><span class="p">,</span> <span class="n">outNewNodeId</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_addDataSourceVariableNode</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span>
                                    <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">requestedNewNodeId</span><span class="p">,</span>
                                    <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">parentNodeId</span><span class="p">,</span>
                                    <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">referenceTypeId</span><span class="p">,</span>
                                    <span class="k">const</span> <span class="n">UA_QualifiedName</span> <span class="n">browseName</span><span class="p">,</span>
                                    <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">typeDefinition</span><span class="p">,</span>
                                    <span class="k">const</span> <span class="n">UA_VariableAttributes</span> <span class="n">attr</span><span class="p">,</span>
                                    <span class="k">const</span> <span class="n">UA_DataSource</span> <span class="n">dataSource</span><span class="p">,</span>
                                    <span class="kt">void</span> <span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">outNewNodeId</span><span class="p">);</span>

<span class="cp">#ifdef UA_ENABLE_METHODCALLS</span>

<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_addMethodNodeEx</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">requestedNewNodeId</span><span class="p">,</span>
                          <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">parentNodeId</span><span class="p">,</span>
                          <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">referenceTypeId</span><span class="p">,</span>
                          <span class="k">const</span> <span class="n">UA_QualifiedName</span> <span class="n">browseName</span><span class="p">,</span>
                          <span class="k">const</span> <span class="n">UA_MethodAttributes</span> <span class="n">attr</span><span class="p">,</span> <span class="n">UA_MethodCallback</span> <span class="n">method</span><span class="p">,</span>
                          <span class="kt">size_t</span> <span class="n">inputArgumentsSize</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_Argument</span> <span class="o">*</span><span class="n">inputArguments</span><span class="p">,</span>
                          <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">inputArgumentsRequestedNewNodeId</span><span class="p">,</span>
                          <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">inputArgumentsOutNewNodeId</span><span class="p">,</span>
                          <span class="kt">size_t</span> <span class="n">outputArgumentsSize</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_Argument</span> <span class="o">*</span><span class="n">outputArguments</span><span class="p">,</span>
                          <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">outputArgumentsRequestedNewNodeId</span><span class="p">,</span>
                          <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">outputArgumentsOutNewNodeId</span><span class="p">,</span>
                          <span class="kt">void</span> <span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">outNewNodeId</span><span class="p">);</span>

<span class="k">static</span> <span class="n">UA_INLINE</span> <span class="n">UA_THREADSAFE</span> <span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_addMethodNode</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">requestedNewNodeId</span><span class="p">,</span>
                        <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">parentNodeId</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">referenceTypeId</span><span class="p">,</span>
                        <span class="k">const</span> <span class="n">UA_QualifiedName</span> <span class="n">browseName</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_MethodAttributes</span> <span class="n">attr</span><span class="p">,</span>
                        <span class="n">UA_MethodCallback</span> <span class="n">method</span><span class="p">,</span>
                        <span class="kt">size_t</span> <span class="n">inputArgumentsSize</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_Argument</span> <span class="o">*</span><span class="n">inputArguments</span><span class="p">,</span>
                        <span class="kt">size_t</span> <span class="n">outputArgumentsSize</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_Argument</span> <span class="o">*</span><span class="n">outputArguments</span><span class="p">,</span>
                        <span class="kt">void</span> <span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">outNewNodeId</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">UA_Server_addMethodNodeEx</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="n">requestedNewNodeId</span><span class="p">,</span>  <span class="n">parentNodeId</span><span class="p">,</span>
                                     <span class="n">referenceTypeId</span><span class="p">,</span> <span class="n">browseName</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span>
                                     <span class="n">inputArgumentsSize</span><span class="p">,</span> <span class="n">inputArguments</span><span class="p">,</span> <span class="n">UA_NODEID_NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span>
                                     <span class="n">outputArgumentsSize</span><span class="p">,</span> <span class="n">outputArguments</span><span class="p">,</span> <span class="n">UA_NODEID_NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span>
                                     <span class="n">nodeContext</span><span class="p">,</span> <span class="n">outNewNodeId</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">#endif</span>
</pre></div>
</div>
<p>The method pair UA_Server_addNode_begin and _finish splits the AddNodes
service in two parts. This is useful if the node shall be modified before
finish the instantiation. For example to add children with specific NodeIds.
Otherwise, mandatory children (e.g. of an ObjectType) are added with
pseudo-random unique NodeIds. Existing children are detected during the
_finish part via their matching BrowseName.</p>
<dl class="simple">
<dt>The _begin method:</dt><dd><ul class="simple">
<li><p>prepares the node and adds it to the nodestore</p></li>
<li><p>copies some unassigned attributes from the TypeDefinition node internally</p></li>
<li><p>adds the references to the parent (and the TypeDefinition if applicable)</p></li>
<li><p>performs type-checking of variables.</p></li>
</ul>
</dd>
</dl>
<p>You can add an object node without a parent if you set the parentNodeId and
referenceTypeId to UA_NODE_ID_NULL. Then you need to add the parent reference
and hasTypeDef reference yourself before calling the _finish method.
Not that this is only allowed for object nodes.</p>
<dl class="simple">
<dt>The _finish method:</dt><dd><ul class="simple">
<li><p>copies mandatory children</p></li>
<li><p>calls the node constructor(s) at the end</p></li>
<li><p>may remove the node if it encounters an error.</p></li>
</ul>
</dd>
</dl>
<p>The special UA_Server_addMethodNode_finish method needs to be used for
method nodes, since there you need to explicitly specifiy the input
and output arguments which are added in the finish step (if not yet already there)</p>
<p><code class="docutils literal notranslate"><span class="pre">VariableAttributes</span></code> for variables, <code class="docutils literal notranslate"><span class="pre">ObjectAttributes</span></code> for objects, and
so on. Missing attributes are taken from the TypeDefinition node if
applicable.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_addNode_begin</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeClass</span> <span class="n">nodeClass</span><span class="p">,</span>
                        <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">requestedNewNodeId</span><span class="p">,</span>
                        <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">parentNodeId</span><span class="p">,</span>
                        <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">referenceTypeId</span><span class="p">,</span>
                        <span class="k">const</span> <span class="n">UA_QualifiedName</span> <span class="n">browseName</span><span class="p">,</span>
                        <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">typeDefinition</span><span class="p">,</span>
                        <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">attr</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_DataType</span> <span class="o">*</span><span class="n">attributeType</span><span class="p">,</span>
                        <span class="kt">void</span> <span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">outNewNodeId</span><span class="p">);</span>

<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_addNode_finish</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">);</span>

<span class="cp">#ifdef UA_ENABLE_METHODCALLS</span>

<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_addMethodNode_finish</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                         <span class="n">UA_MethodCallback</span> <span class="n">method</span><span class="p">,</span>
                         <span class="kt">size_t</span> <span class="n">inputArgumentsSize</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_Argument</span><span class="o">*</span> <span class="n">inputArguments</span><span class="p">,</span>
                         <span class="kt">size_t</span> <span class="n">outputArgumentsSize</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_Argument</span><span class="o">*</span> <span class="n">outputArguments</span><span class="p">);</span>

<span class="cp">#endif</span>

<span class="cm">/* Deletes a node and optionally all references leading to the node. */</span>
<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_deleteNode</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">nodeId</span><span class="p">,</span>
                     <span class="n">UA_Boolean</span> <span class="n">deleteReferences</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="reference-management">
<h2>Reference Management<a class="headerlink" href="#reference-management" title="Permalink to this headline">¶</a></h2>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_addReference</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">sourceId</span><span class="p">,</span>
                       <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">refTypeId</span><span class="p">,</span>
                       <span class="k">const</span> <span class="n">UA_ExpandedNodeId</span> <span class="n">targetId</span><span class="p">,</span> <span class="n">UA_Boolean</span> <span class="n">isForward</span><span class="p">);</span>

<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_deleteReference</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">sourceNodeId</span><span class="p">,</span>
                          <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">referenceTypeId</span><span class="p">,</span> <span class="n">UA_Boolean</span> <span class="n">isForward</span><span class="p">,</span>
                          <span class="k">const</span> <span class="n">UA_ExpandedNodeId</span> <span class="n">targetNodeId</span><span class="p">,</span>
                          <span class="n">UA_Boolean</span> <span class="n">deleteBidirectional</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="events">
<span id="id6"></span><h2>Events<a class="headerlink" href="#events" title="Permalink to this headline">¶</a></h2>
<p>The method <code class="docutils literal notranslate"><span class="pre">UA_Server_createEvent</span></code> creates an event and represents it as node. The node receives a unique <cite>EventId</cite>
which is automatically added to the node.
The method returns a <cite>NodeId</cite> to the object node which represents the event through <code class="docutils literal notranslate"><span class="pre">outNodeId</span></code>. The <cite>NodeId</cite> can
be used to set the attributes of the event. The generated <cite>NodeId</cite> is always numeric. <code class="docutils literal notranslate"><span class="pre">outNodeId</span></code> cannot be
<code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p>
<p>Note: In order to see an event in UAExpert, the field <cite>Time</cite> must be given a value!</p>
<p>The method <code class="docutils literal notranslate"><span class="pre">UA_Server_triggerEvent</span></code> “triggers” an event by adding it to all monitored items of the specified
origin node and those of all its parents. Any filters specified by the monitored items are automatically applied.
Using this method deletes the node generated by <code class="docutils literal notranslate"><span class="pre">UA_Server_createEvent</span></code>. The <cite>EventId</cite> for the new event is
generated automatically and is returned through <code class="docutils literal notranslate"><span class="pre">outEventId</span></code>. <code class="docutils literal notranslate"><span class="pre">NULL</span></code> can be passed if the <cite>EventId</cite> is not
needed. <code class="docutils literal notranslate"><span class="pre">deleteEventNode</span></code> specifies whether the node representation of the event should be deleted after invoking
the method. This can be useful if events with the similar attributes are triggered frequently. <code class="docutils literal notranslate"><span class="pre">UA_TRUE</span></code> would
cause the node to be deleted.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifdef UA_ENABLE_SUBSCRIPTIONS_EVENTS</span>

<span class="cm">/* The EventQueueOverflowEventType is defined as abstract, therefore we can not</span>
<span class="cm"> * create an instance of that type directly, but need to create a subtype. The</span>
<span class="cm"> * following is an arbitrary number which shall refer to our internal overflow</span>
<span class="cm"> * type. This is already posted on the OPC Foundation bug tracker under the</span>
<span class="cm"> * following link for clarification:</span>
<span class="cm"> * https://opcfoundation-onlineapplications.org/mantis/view.php?id=4206 */</span>
<span class="cp"># define UA_NS0ID_SIMPLEOVERFLOWEVENTTYPE 4035</span>

<span class="cm">/* Creates a node representation of an event</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object</span>
<span class="cm"> * @param eventType The type of the event for which a node should be created</span>
<span class="cm"> * @param outNodeId The NodeId of the newly created node for the event</span>
<span class="cm"> * @return The StatusCode of the UA_Server_createEvent method */</span>
<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_createEvent</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">eventType</span><span class="p">,</span>
                      <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">outNodeId</span><span class="p">);</span>

<span class="cm">/* Triggers a node representation of an event by applying EventFilters and</span>
<span class="cm">   adding the event to the appropriate queues.</span>
<span class="cm"> * @param server The server object</span>
<span class="cm"> * @param eventNodeId The NodeId of the node representation of the event which should be triggered</span>
<span class="cm"> * @param outEvent the EventId of the new event</span>
<span class="cm"> * @param deleteEventNode Specifies whether the node representation of the event should be deleted</span>
<span class="cm"> * @return The StatusCode of the UA_Server_triggerEvent method */</span>
<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_triggerEvent</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">eventNodeId</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">originId</span><span class="p">,</span>
                       <span class="n">UA_ByteString</span> <span class="o">*</span><span class="n">outEventId</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_Boolean</span> <span class="n">deleteEventNode</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* UA_ENABLE_SUBSCRIPTIONS_EVENTS */</span><span class="cp"></span>

<span class="cp">#ifdef UA_ENABLE_SUBSCRIPTIONS_ALARMS_CONDITIONS</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">UA_TwoStateVariableCallbackType</span> <span class="p">{</span>
  <span class="n">UA_ENTERING_ENABLEDSTATE</span><span class="p">,</span>
  <span class="n">UA_ENTERING_ACKEDSTATE</span><span class="p">,</span>
  <span class="n">UA_ENTERING_CONFIRMEDSTATE</span><span class="p">,</span>
  <span class="n">UA_ENTERING_ACTIVESTATE</span>
<span class="p">}</span> <span class="n">UA_TwoStateVariableCallbackType</span><span class="p">;</span>
</pre></div>
</div>
<p>callback prototype to set user specific callbacks</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="nf">UA_StatusCode</span>
<span class="p">(</span><span class="o">*</span><span class="n">UA_TwoStateVariableChangeCallback</span><span class="p">)(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">condition</span><span class="p">);</span>
</pre></div>
</div>
<p>create condition instance. The function checks first whether the passed conditionType
is a subType of ConditionType. Then checks whether the condition source has HasEventSource
reference to its parent. If not, a HasEventSource reference will be created between condition
source and server object. To expose the condition in address space, a hierarchical ReferenceType
should be passed to create the reference to condition source. Otherwise, UA_NODEID_NULL should be
passed to make the condition not exposed.
&#64;param server The server object
&#64;param conditionId The NodeId of the requested Condition Object. UA_NODEID_NULL for random Id with NS Idx = 0.
&#64;param conditionType The NodeId of the node representation of the ConditionType
&#64;param conditionName The name of the condition to be created
&#64;param conditionSource The NodeId of the Condition Source (Parent of the Condition)
&#64;param hierarchialReferenceType The NodeId of Hierarchical ReferenceType between Condition and its source
&#64;param outConditionId The NodeId of the created Condition
&#64;return The StatusCode of the UA_Server_createCondition method</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_createCondition</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span>
                          <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">conditionId</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">conditionType</span><span class="p">,</span>
                          <span class="n">UA_QualifiedName</span> <span class="n">conditionName</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">conditionSource</span><span class="p">,</span>
                          <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">hierarchialReferenceType</span><span class="p">,</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">outConditionId</span><span class="p">);</span>
</pre></div>
</div>
<p>set the value of condition field.
&#64;param server The server object
&#64;param condition The NodeId of the node representation of the Condition Instance
&#64;param value Variant Value to be written to the Field
&#64;param fieldName Name of the Field in which the value should be written
&#64;return The StatusCode of the UA_Server_setConditionField method*/</p>
<p>set the value of property of condition field.
&#64;param server The server object
&#64;param condition The NodeId of the node representation of the Condition Instance
&#64;param value Variant Value to be written to the Field
&#64;param variableFieldName Name of the Field which has a property
&#64;param variablePropertyName Name of the Field Property in which the value should be written
&#64;return The StatusCode of the UA_Server_setConditionVariableFieldProperty*/</p>
<p>triggers an event only for an enabled condition. The condition list is updated then with the
last generated EventId.
&#64;param server The server object
&#64;param condition The NodeId of the node representation of the Condition Instance
&#64;param conditionSource The NodeId of the node representation of the Condition Source
&#64;param outEventId last generated EventId
&#64;return The StatusCode of the UA_Server_triggerConditionEvent method*/</p>
<p>add an optional condition field using its name. (TODO Adding optional methods
is not implemented yet)
&#64;param server The server object
&#64;param condition The NodeId of the node representation of the Condition Instance
&#64;param conditionType The NodeId of the node representation of the Condition Type
from which the optional field comes
&#64;param fieldName Name of the optional field
&#64;param outOptionalVariable The NodeId of the created field (Variable Node)
&#64;return The StatusCode of the UA_Server_addConditionOptionalField method*/</p>
<p>Function used to set a user specific callback to TwoStateVariable Fields of
a condition. The callbacks will be called before triggering the events when
transition to true State of EnabledState/Id, AckedState/Id, ConfirmedState/Id
and ActiveState/Id occurs.
&#64;param server The server object
&#64;param condition The NodeId of the node representation of the Condition Instance
&#64;param conditionSource The NodeId of the node representation of the Condition Source
&#64;param removeBranch (Not Implemented yet)
&#64;param callback User specific callback function
&#64;param callbackType Callback function type, indicates where it should be called
&#64;return The StatusCode of the UA_Server_setConditionTwoStateVariableCallback method*/</p>
</div>
<div class="section" id="utility-functions">
<h2>Utility Functions<a class="headerlink" href="#utility-functions" title="Permalink to this headline">¶</a></h2>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Add a new namespace to the server. Returns the index of the new namespace */</span>
<span class="n">UA_UInt16</span> <span class="n">UA_THREADSAFE</span> <span class="nf">UA_Server_addNamespace</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">name</span><span class="p">);</span>

<span class="cm">/* Get namespace by name from the server. */</span>
<span class="n">UA_StatusCode</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_getNamespaceByName</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_String</span> <span class="n">namespaceUri</span><span class="p">,</span>
                             <span class="kt">size_t</span><span class="o">*</span> <span class="n">foundIndex</span><span class="p">);</span>

<span class="cp">#ifdef UA_ENABLE_HISTORIZING</span>
<span class="n">UA_Boolean</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_AccessControl_allowHistoryUpdateUpdateData</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span>
                                                     <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">sessionId</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">sessionContext</span><span class="p">,</span>
                                                     <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">nodeId</span><span class="p">,</span>
                                                     <span class="n">UA_PerformUpdateType</span> <span class="n">performInsertReplace</span><span class="p">,</span>
                                                     <span class="k">const</span> <span class="n">UA_DataValue</span> <span class="o">*</span><span class="n">value</span><span class="p">);</span>

<span class="n">UA_Boolean</span> <span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_AccessControl_allowHistoryUpdateDeleteRawModified</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span>
                                                            <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">sessionId</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">sessionContext</span><span class="p">,</span>
                                                            <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">nodeId</span><span class="p">,</span>
                                                            <span class="n">UA_DateTime</span> <span class="n">startTimestamp</span><span class="p">,</span>
                                                            <span class="n">UA_DateTime</span> <span class="n">endTimestamp</span><span class="p">,</span>
                                                            <span class="kt">bool</span> <span class="n">isDeleteModified</span><span class="p">);</span>
<span class="cp">#endif </span><span class="c1">// UA_ENABLE_HISTORIZING</span>
</pre></div>
</div>
</div>
<div class="section" id="async-operations">
<span id="id7"></span><h2>Async Operations<a class="headerlink" href="#async-operations" title="Permalink to this headline">¶</a></h2>
<p>Some operations (such as reading out a sensor that needs to warm up) can take
quite some time. In order not to block the server during such an operation, it
can be “outsourced” to a worker thread.</p>
<p>Take the example of a CallRequest. It is split into the individual method call
operations. If the method is marked as async, then the operation is put into a
queue where it is be retrieved by a worker. The worker returns the result when
ready. See the examples in <code class="docutils literal notranslate"><span class="pre">/examples/tutorial_server_method_async.c</span></code> for
the usage.</p>
<p>Note that the operation can time out (see the asyncOperationTimeout setting in
the server config) also when it has been retrieved by the worker.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#if UA_MULTITHREADING &gt;= 100</span>

<span class="cm">/* Set the async flag in a method node */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_setMethodNodeAsync</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="n">id</span><span class="p">,</span>
                             <span class="n">UA_Boolean</span> <span class="n">isAsync</span><span class="p">);</span>

<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>
    <span class="n">UA_ASYNCOPERATIONTYPE_INVALID</span><span class="p">,</span> <span class="cm">/* 0, the default */</span>
    <span class="n">UA_ASYNCOPERATIONTYPE_CALL</span>
    <span class="cm">/* UA_ASYNCOPERATIONTYPE_READ, */</span>
    <span class="cm">/* UA_ASYNCOPERATIONTYPE_WRITE, */</span>
<span class="p">}</span> <span class="n">UA_AsyncOperationType</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">union</span> <span class="p">{</span>
    <span class="n">UA_CallMethodRequest</span> <span class="n">callMethodRequest</span><span class="p">;</span>
    <span class="cm">/* UA_ReadValueId readValueId; */</span>
    <span class="cm">/* UA_WriteValue writeValue; */</span>
<span class="p">}</span> <span class="n">UA_AsyncOperationRequest</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">union</span> <span class="p">{</span>
    <span class="n">UA_CallMethodResult</span> <span class="n">callMethodResult</span><span class="p">;</span>
    <span class="cm">/* UA_DataValue readResult; */</span>
    <span class="cm">/* UA_StatusCode writeResult; */</span>
<span class="p">}</span> <span class="n">UA_AsyncOperationResponse</span><span class="p">;</span>

<span class="cm">/* Get the next async operation without blocking</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object</span>
<span class="cm"> * @param type The type of the async operation</span>
<span class="cm"> * @param request Receives pointer to the operation</span>
<span class="cm"> * @param context Receives the pointer to the operation context</span>
<span class="cm"> * @param timeout The timestamp when the operation times out and can</span>
<span class="cm"> *        no longer be returned to the client. The response has to</span>
<span class="cm"> *        be set in UA_Server_setAsyncOperationResult in any case.</span>
<span class="cm"> * @return false if queue is empty, true else */</span>
<span class="n">UA_Boolean</span>
<span class="nf">UA_Server_getAsyncOperationNonBlocking</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_AsyncOperationType</span> <span class="o">*</span><span class="n">type</span><span class="p">,</span>
                                       <span class="k">const</span> <span class="n">UA_AsyncOperationRequest</span> <span class="o">**</span><span class="n">request</span><span class="p">,</span>
                                       <span class="kt">void</span> <span class="o">**</span><span class="n">context</span><span class="p">,</span> <span class="n">UA_DateTime</span> <span class="o">*</span><span class="n">timeout</span><span class="p">);</span>

<span class="cm">/* UA_Boolean */</span>
<span class="cm">/* UA_Server_getAsyncOperationBlocking(UA_Server *server, UA_AsyncOperationType *type, */</span>
<span class="cm">/*                                     const UA_AsyncOperationRequest **request, */</span>
<span class="cm">/*                                     void **context, UA_DateTime *timeout); */</span>

<span class="cm">/* Submit an async operation result</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object</span>
<span class="cm"> * @param response Pointer to the operation result</span>
<span class="cm"> * @param context Pointer to the operation context */</span>
<span class="kt">void</span>
<span class="nf">UA_Server_setAsyncOperationResult</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span>
                                  <span class="k">const</span> <span class="n">UA_AsyncOperationResponse</span> <span class="o">*</span><span class="n">response</span><span class="p">,</span>
                                  <span class="kt">void</span> <span class="o">*</span><span class="n">context</span><span class="p">);</span>

<span class="cm">/* Get the next async operation. Attention! This method is deprecated and has</span>
<span class="cm"> * been replaced by UA_Server_getAsyncOperationNonBlocking! */</span>
<span class="n">UA_DEPRECATED</span> <span class="n">UA_Boolean</span>
<span class="nf">UA_Server_getAsyncOperation</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_AsyncOperationType</span> <span class="o">*</span><span class="n">type</span><span class="p">,</span>
                            <span class="k">const</span> <span class="n">UA_AsyncOperationRequest</span> <span class="o">**</span><span class="n">request</span><span class="p">,</span>
                            <span class="kt">void</span> <span class="o">**</span><span class="n">context</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* !UA_MULTITHREADING &gt;= 100 */</span><span class="cp"></span>
</pre></div>
</div>
</div>
<div class="section" id="statistics">
<h2>Statistics<a class="headerlink" href="#statistics" title="Permalink to this headline">¶</a></h2>
<p>Statistic counters keeping track of the current state of the stack. Counters
are structured per OPC UA communication layer.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
   <span class="n">UA_NetworkStatistics</span> <span class="n">ns</span><span class="p">;</span>
   <span class="n">UA_SecureChannelStatistics</span> <span class="n">scs</span><span class="p">;</span>
   <span class="n">UA_SessionStatistics</span> <span class="n">ss</span><span class="p">;</span>
<span class="p">}</span> <span class="n">UA_ServerStatistics</span><span class="p">;</span>

<span class="n">UA_ServerStatistics</span> <span class="nf">UA_Server_getStatistics</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="client.html" class="btn btn-neutral float-right" title="Client" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="nodestore.html" class="btn btn-neutral float-left" title="Information Modelling" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, The open62541 authors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>