

<!DOCTYPE html>
<html class="writer-html4" lang="" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Information Modelling &mdash; open62541 1.0.5-1-g982f0796 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'./',
              VERSION:'1.0.5-1-g982f0796',
              LANGUAGE:'',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: ''
          };
      </script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="next" title="Server" href="server.html" />
    <link rel="prev" title="Services" href="services.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="toc.html" class="icon icon-home"> open62541
          

          
            
            <img src="_static/open62541_html.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="building.html">Building open62541</a></li>
<li class="toctree-l1"><a class="reference internal" href="installing.html">Installing open62541</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="protocol.html">Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="types.html">Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="services.html">Services</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Information Modelling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#base-node-attributes">Base Node Attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#variablenode">VariableNode</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#data-type">Data Type</a></li>
<li class="toctree-l3"><a class="reference internal" href="#value-rank">Value Rank</a></li>
<li class="toctree-l3"><a class="reference internal" href="#array-dimensions">Array Dimensions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#variabletypenode">VariableTypeNode</a></li>
<li class="toctree-l2"><a class="reference internal" href="#methodnode">MethodNode</a></li>
<li class="toctree-l2"><a class="reference internal" href="#objectnode">ObjectNode</a></li>
<li class="toctree-l2"><a class="reference internal" href="#objecttypenode">ObjectTypeNode</a></li>
<li class="toctree-l2"><a class="reference internal" href="#referencetypenode">ReferenceTypeNode</a></li>
<li class="toctree-l2"><a class="reference internal" href="#datatypenode">DataTypeNode</a></li>
<li class="toctree-l2"><a class="reference internal" href="#viewnode">ViewNode</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#nodestore-plugin-api">Nodestore Plugin API</a></li>
<li class="toctree-l1"><a class="reference internal" href="#node-handling">Node Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="server.html">Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="client.html">Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="constants.html">Standard-Defined Constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="constants.html#internal-constants">Internal Constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="nodeset_compiler.html">XML Nodeset Compiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="internal.html">Internals</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="toc.html">open62541</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="toc.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Information Modelling</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/nodestore.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="information-modelling">
<span id="id1"></span><h1>Information Modelling<a class="headerlink" href="#information-modelling" title="Permalink to this headline">¶</a></h1>
<p>Information modelling in OPC UA combines concepts from object-orientation and
semantic modelling. At the core, an OPC UA information model is a graph made
up of</p>
<ul class="simple">
<li>Nodes: There are eight possible Node types (variable, object, method, ...)</li>
<li>References: Typed and directed relations between two nodes</li>
</ul>
<p>Every node is identified by a unique (within the server) <a class="reference internal" href="types.html#nodeid"><em>NodeId</em></a>.
Reference are triples of the form <tt class="docutils literal"><span class="pre">(source-nodeid,</span> <span class="pre">referencetype-nodeid,</span>
<span class="pre">target-nodeid)</span></tt>. An example reference between nodes is a
<tt class="docutils literal"><span class="pre">hasTypeDefinition</span></tt> reference between a Variable and its VariableType. Some
ReferenceTypes are <em>hierarchic</em> and must not form <em>directed loops</em>. See the
section on <a class="reference internal" href="#referencetypenode"><em>ReferenceTypes</em></a> for more details on
possible references and their semantics.</p>
<p><strong>Warning!!</strong> The structures defined in this section are only relevant for
the developers of custom Nodestores. The interaction with the information
model is possible only via the OPC UA <a class="reference internal" href="services.html#services"><em>Services</em></a>. So the following
sections are purely informational so that users may have a clear mental
model of the underlying representation.</p>
<div class="section" id="base-node-attributes">
<h2>Base Node Attributes<a class="headerlink" href="#base-node-attributes" title="Permalink to this headline">¶</a></h2>
<p>Nodes contain attributes according to their node type. The base node
attributes are common to all node types. In the OPC UA <a class="reference internal" href="services.html#services"><em>Services</em></a>,
attributes are referred to via the <a class="reference internal" href="types.html#nodeid"><em>NodeId</em></a> of the containing node and
an integer <a class="reference internal" href="constants.html#attribute-id"><em>Attribute Id</em></a>.</p>
<p>Internally, open62541 uses <tt class="docutils literal"><span class="pre">UA_Node</span></tt> in places where the exact node type is
not known or not important. The <tt class="docutils literal"><span class="pre">nodeClass</span></tt> attribute is used to ensure the
correctness of casting from <tt class="docutils literal"><span class="pre">UA_Node</span></tt> to a specific node type.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cm">/* Ordered tree structure for fast member check */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">UA_ReferenceTarget</span> <span class="p">{</span>
    <span class="n">ZIP_ENTRY</span><span class="p">(</span><span class="n">UA_ReferenceTarget</span><span class="p">)</span> <span class="n">zipfields</span><span class="p">;</span>
    <span class="n">UA_UInt32</span> <span class="n">targetHash</span><span class="p">;</span> <span class="cm">/* Hash of the target nodeid */</span>
    <span class="n">UA_ExpandedNodeId</span> <span class="n">target</span><span class="p">;</span>
<span class="p">}</span> <span class="n">UA_ReferenceTarget</span><span class="p">;</span>

<span class="n">ZIP_HEAD</span><span class="p">(</span><span class="n">UA_ReferenceTargetHead</span><span class="p">,</span> <span class="n">UA_ReferenceTarget</span><span class="p">);</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">UA_ReferenceTargetHead</span> <span class="n">UA_ReferenceTargetHead</span><span class="p">;</span>
<span class="n">ZIP_PROTTYPE</span><span class="p">(</span><span class="n">UA_ReferenceTargetHead</span><span class="p">,</span> <span class="n">UA_ReferenceTarget</span><span class="p">,</span> <span class="n">UA_ReferenceTarget</span><span class="p">)</span>

<span class="cm">/* List of reference targets with the same reference type and direction */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">UA_NodeId</span> <span class="n">referenceTypeId</span><span class="p">;</span>
    <span class="n">UA_Boolean</span> <span class="n">isInverse</span><span class="p">;</span>
    <span class="kt">size_t</span> <span class="n">refTargetsSize</span><span class="p">;</span>
    <span class="n">UA_ReferenceTarget</span> <span class="o">*</span><span class="n">refTargets</span><span class="p">;</span>
    <span class="n">UA_ReferenceTargetHead</span> <span class="n">refTargetsTree</span><span class="p">;</span>
<span class="p">}</span> <span class="n">UA_NodeReferenceKind</span><span class="p">;</span>

<span class="cp">#define UA_NODE_BASEATTRIBUTES                  \</span>
<span class="cp">    UA_NodeId nodeId;                           \</span>
<span class="cp">    UA_NodeClass nodeClass;                     \</span>
<span class="cp">    UA_QualifiedName browseName;                \</span>
<span class="cp">    UA_LocalizedText displayName;               \</span>
<span class="cp">    UA_LocalizedText description;               \</span>
<span class="cp">    UA_UInt32 writeMask;                        \</span>
<span class="cp">    size_t referencesSize;                      \</span>
<span class="cp">    UA_NodeReferenceKind *references;           \</span>
<span class="cp">                                                \</span>
<span class="cp">    </span><span class="cm">/* Members specific to open62541 */</span><span class="cp">         \</span>
<span class="cp">    void *context;                              \</span>
<span class="cp">    UA_Boolean constructed; </span><span class="cm">/* Constructors were called */</span><span class="cp"></span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">UA_NODE_BASEATTRIBUTES</span>
<span class="p">}</span> <span class="n">UA_Node</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="variablenode">
<h2>VariableNode<a class="headerlink" href="#variablenode" title="Permalink to this headline">¶</a></h2>
<p>Variables store values in a <a class="reference internal" href="types.html#datavalue"><em>DataValue</em></a> together with
metadata for introspection. Most notably, the attributes data type, value
rank and array dimensions constrain the possible values the variable can take
on.</p>
<p>Variables come in two flavours: properties and datavariables. Properties are
related to a parent with a <tt class="docutils literal"><span class="pre">hasProperty</span></tt> reference and may not have child
nodes themselves. Datavariables may contain properties (<tt class="docutils literal"><span class="pre">hasProperty</span></tt>) and
also datavariables (<tt class="docutils literal"><span class="pre">hasComponents</span></tt>).</p>
<p>All variables are instances of some <a class="reference internal" href="#variabletypenode"><em>VariableTypeNode</em></a> in return
constraining the possible data type, value rank and array dimensions
attributes.</p>
<div class="section" id="data-type">
<h3>Data Type<a class="headerlink" href="#data-type" title="Permalink to this headline">¶</a></h3>
<p>The (scalar) data type of the variable is constrained to be of a specific
type or one of its children in the type hierarchy. The data type is given as
a NodeId pointing to a <a class="reference internal" href="#datatypenode"><em>DataTypeNode</em></a> in the type hierarchy. See the
Section <a class="reference internal" href="#datatypenode"><em>DataTypeNode</em></a> for more details.</p>
<p>If the data type attribute points to <tt class="docutils literal"><span class="pre">UInt32</span></tt>, then the value attribute
must be of that exact type since <tt class="docutils literal"><span class="pre">UInt32</span></tt> does not have children in the
type hierarchy. If the data type attribute points <tt class="docutils literal"><span class="pre">Number</span></tt>, then the type
of the value attribute may still be <tt class="docutils literal"><span class="pre">UInt32</span></tt>, but also <tt class="docutils literal"><span class="pre">Float</span></tt> or
<tt class="docutils literal"><span class="pre">Byte</span></tt>.</p>
<p>Consistency between the data type attribute in the variable and its
<a class="reference internal" href="#variabletypenode"><em>VariableTypeNode</em></a> is ensured.</p>
</div>
<div class="section" id="value-rank">
<h3>Value Rank<a class="headerlink" href="#value-rank" title="Permalink to this headline">¶</a></h3>
<p>This attribute indicates whether the value attribute of the variable is an
array and how many dimensions the array has. It may have the following
values:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span> <span class="pre">&gt;=</span> <span class="pre">1</span></tt>: the value is an array with the specified number of dimensions</li>
<li><tt class="docutils literal"><span class="pre">n</span> <span class="pre">=</span>&nbsp; <span class="pre">0</span></tt>: the value is an array with one or more dimensions</li>
<li><tt class="docutils literal"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">-1</span></tt>: the value is a scalar</li>
<li><tt class="docutils literal"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">-2</span></tt>: the value can be a scalar or an array with any number of dimensions</li>
<li><tt class="docutils literal"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">-3</span></tt>: the value can be a scalar or a one dimensional array</li>
</ul>
<p>Consistency between the value rank attribute in the variable and its
<a class="reference internal" href="#variabletypenode"><em>VariableTypeNode</em></a> is ensured.</p>
</div>
<div class="section" id="array-dimensions">
<h3>Array Dimensions<a class="headerlink" href="#array-dimensions" title="Permalink to this headline">¶</a></h3>
<p>If the value rank permits the value to be a (multi-dimensional) array, the
exact length in each dimensions can be further constrained with this
attribute.</p>
<ul class="simple">
<li>For positive lengths, the variable value is guaranteed to be of the same
length in this dimension.</li>
<li>The dimension length zero is a wildcard and the actual value may have any
length in this dimension.</li>
</ul>
<p>Consistency between the array dimensions attribute in the variable and its
<a class="reference internal" href="#variabletypenode"><em>VariableTypeNode</em></a> is ensured.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cm">/* Indicates whether a variable contains data inline or whether it points to an</span>
<span class="cm"> * external data source */</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>
    <span class="n">UA_VALUESOURCE_DATA</span><span class="p">,</span>
    <span class="n">UA_VALUESOURCE_DATASOURCE</span>
<span class="p">}</span> <span class="n">UA_ValueSource</span><span class="p">;</span>

<span class="cp">#define UA_NODE_VARIABLEATTRIBUTES                                      \</span>
<span class="cp">    </span><span class="cm">/* Constraints on possible values */</span><span class="cp">                                \</span>
<span class="cp">    UA_NodeId dataType;                                                 \</span>
<span class="cp">    UA_Int32 valueRank;                                                 \</span>
<span class="cp">    size_t arrayDimensionsSize;                                         \</span>
<span class="cp">    UA_UInt32 *arrayDimensions;                                         \</span>
<span class="cp">                                                                        \</span>
<span class="cp">    </span><span class="cm">/* The current value */</span><span class="cp">                                             \</span>
<span class="cp">    UA_ValueSource valueSource;                                         \</span>
<span class="cp">    union {                                                             \</span>
<span class="cp">        struct {                                                        \</span>
<span class="cp">            UA_DataValue value;                                         \</span>
<span class="cp">            UA_ValueCallback callback;                                  \</span>
<span class="cp">        } data;                                                         \</span>
<span class="cp">        UA_DataSource dataSource;                                       \</span>
<span class="cp">    } value;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">UA_NODE_BASEATTRIBUTES</span>
    <span class="n">UA_NODE_VARIABLEATTRIBUTES</span>
    <span class="n">UA_Byte</span> <span class="n">accessLevel</span><span class="p">;</span>
    <span class="n">UA_Double</span> <span class="n">minimumSamplingInterval</span><span class="p">;</span>
    <span class="n">UA_Boolean</span> <span class="n">historizing</span><span class="p">;</span>

    <span class="cm">/* Members specific to open62541 */</span>
    <span class="n">UA_Boolean</span> <span class="n">isDynamic</span><span class="p">;</span> <span class="cm">/* Some variables are &quot;static&quot; in the sense that they</span>
<span class="cm">                           * are not attached to a dynamic process in the</span>
<span class="cm">                           * background. Only dynamic variables conserve source</span>
<span class="cm">                           * and server timestamp for the value attribute.</span>
<span class="cm">                           * Static variables have timestamps of &quot;now&quot;. */</span>
<span class="p">}</span> <span class="n">UA_VariableNode</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="variabletypenode">
<span id="id2"></span><h2>VariableTypeNode<a class="headerlink" href="#variabletypenode" title="Permalink to this headline">¶</a></h2>
<p>VariableTypes are used to provide type definitions for variables.
VariableTypes constrain the data type, value rank and array dimensions
attributes of variable instances. Furthermore, instantiating from a specific
variable type may provide semantic information. For example, an instance from
<tt class="docutils literal"><span class="pre">MotorTemperatureVariableType</span></tt> is more meaningful than a float variable
instantiated from <tt class="docutils literal"><span class="pre">BaseDataVariable</span></tt>.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">UA_NODE_BASEATTRIBUTES</span>
    <span class="n">UA_NODE_VARIABLEATTRIBUTES</span>
    <span class="n">UA_Boolean</span> <span class="n">isAbstract</span><span class="p">;</span>

    <span class="cm">/* Members specific to open62541 */</span>
    <span class="n">UA_NodeTypeLifecycle</span> <span class="n">lifecycle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">UA_VariableTypeNode</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="methodnode">
<span id="id3"></span><h2>MethodNode<a class="headerlink" href="#methodnode" title="Permalink to this headline">¶</a></h2>
<p>Methods define callable functions and are invoked using the <a class="reference internal" href="services.html#method-services"><em>Call</em></a> service. MethodNodes may have special properties (variable
childen with a <tt class="docutils literal"><span class="pre">hasProperty</span></tt> reference) with the <a class="reference internal" href="types.html#qualifiedname"><em>QualifiedName</em></a> <tt class="docutils literal"><span class="pre">(0,</span>
<span class="pre">&quot;InputArguments&quot;)</span></tt> and <tt class="docutils literal"><span class="pre">(0,</span> <span class="pre">&quot;OutputArguments&quot;)</span></tt>. The input and output
arguments are both described via an array of <tt class="docutils literal"><span class="pre">UA_Argument</span></tt>. While the Call
service uses a generic array of <a class="reference internal" href="types.html#variant"><em>Variant</em></a> for input and output, the
actual argument values are checked to match the signature of the MethodNode.</p>
<p>Note that the same MethodNode may be referenced from several objects (and
object types). For this, the NodeId of the method <em>and of the object
providing context</em> is part of a Call request message.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">UA_NODE_BASEATTRIBUTES</span>
    <span class="n">UA_Boolean</span> <span class="n">executable</span><span class="p">;</span>

    <span class="cm">/* Members specific to open62541 */</span>
    <span class="n">UA_MethodCallback</span> <span class="n">method</span><span class="p">;</span>
<span class="p">}</span> <span class="n">UA_MethodNode</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="objectnode">
<h2>ObjectNode<a class="headerlink" href="#objectnode" title="Permalink to this headline">¶</a></h2>
<p>Objects are used to represent systems, system components, real-world objects
and software objects. Objects are instances of an <a class="reference internal" href="#objecttypenode"><em>object
type</em></a> and may contain variables, methods and further
objects.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">UA_NODE_BASEATTRIBUTES</span>
<span class="cp">#ifdef UA_ENABLE_SUBSCRIPTIONS_EVENTS</span>
    <span class="k">struct</span> <span class="n">UA_MonitoredItem</span> <span class="o">*</span><span class="n">monitoredItemQueue</span><span class="p">;</span>
<span class="cp">#endif</span>
    <span class="n">UA_Byte</span> <span class="n">eventNotifier</span><span class="p">;</span>
<span class="p">}</span> <span class="n">UA_ObjectNode</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="objecttypenode">
<span id="id4"></span><h2>ObjectTypeNode<a class="headerlink" href="#objecttypenode" title="Permalink to this headline">¶</a></h2>
<p>ObjectTypes provide definitions for Objects. Abstract objects cannot be
instantiated. See <a class="reference internal" href="server.html#node-lifecycle"><em>Node Lifecycle: Constructors, Destructors and Node Contexts</em></a> for the use of constructor and
destructor callbacks.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">UA_NODE_BASEATTRIBUTES</span>
    <span class="n">UA_Boolean</span> <span class="n">isAbstract</span><span class="p">;</span>

    <span class="cm">/* Members specific to open62541 */</span>
    <span class="n">UA_NodeTypeLifecycle</span> <span class="n">lifecycle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">UA_ObjectTypeNode</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="referencetypenode">
<span id="id5"></span><h2>ReferenceTypeNode<a class="headerlink" href="#referencetypenode" title="Permalink to this headline">¶</a></h2>
<p>Each reference between two nodes is typed with a ReferenceType that gives
meaning to the relation. The OPC UA standard defines a set of ReferenceTypes
as a mandatory part of OPC UA information models.</p>
<ul class="simple">
<li>Abstract ReferenceTypes cannot be used in actual references and are only
used to structure the ReferenceTypes hierarchy</li>
<li>Symmetric references have the same meaning from the perspective of the
source and target node</li>
</ul>
<p>The figure below shows the hierarchy of the standard ReferenceTypes (arrows
indicate a <tt class="docutils literal"><span class="pre">hasSubType</span></tt> relation). Refer to Part 3 of the OPC UA
specification for the full semantics of each ReferenceType.</p>
<p class="graphviz">
<img src="_images/graphviz-dc4d4766bd63c7d129b83e27da433a02bbcc7a61.png" alt="digraph tree {

node [height=0, shape=box, fillcolor=&quot;#E5E5E5&quot;, concentrate=true]

references [label=&quot;References\n(Abstract, Symmetric)&quot;]
hierarchical_references [label=&quot;HierarchicalReferences\n(Abstract)&quot;]
references -&gt; hierarchical_references

nonhierarchical_references [label=&quot;NonHierarchicalReferences\n(Abstract, Symmetric)&quot;]
references -&gt; nonhierarchical_references

haschild [label=&quot;HasChild\n(Abstract)&quot;]
hierarchical_references -&gt; haschild

aggregates [label=&quot;Aggregates\n(Abstract)&quot;]
haschild -&gt; aggregates

organizes [label=&quot;Organizes&quot;]
hierarchical_references -&gt; organizes

hascomponent [label=&quot;HasComponent&quot;]
aggregates -&gt; hascomponent

hasorderedcomponent [label=&quot;HasOrderedComponent&quot;]
hascomponent -&gt; hasorderedcomponent

hasproperty [label=&quot;HasProperty&quot;]
aggregates -&gt; hasproperty

hassubtype [label=&quot;HasSubtype&quot;]
haschild -&gt; hassubtype

hasmodellingrule [label=&quot;HasModellingRule&quot;]
nonhierarchical_references -&gt; hasmodellingrule

hastypedefinition [label=&quot;HasTypeDefinition&quot;]
nonhierarchical_references -&gt; hastypedefinition

hasencoding [label=&quot;HasEncoding&quot;]
nonhierarchical_references -&gt; hasencoding

hasdescription [label=&quot;HasDescription&quot;]
nonhierarchical_references -&gt; hasdescription

haseventsource [label=&quot;HasEventSource&quot;]
hierarchical_references -&gt; haseventsource

hasnotifier [label=&quot;HasNotifier&quot;]
hierarchical_references -&gt; hasnotifier

generatesevent [label=&quot;GeneratesEvent&quot;]
nonhierarchical_references -&gt; generatesevent

alwaysgeneratesevent [label=&quot;AlwaysGeneratesEvent&quot;]
generatesevent -&gt; alwaysgeneratesevent

{rank=same hierarchical_references nonhierarchical_references}
{rank=same generatesevent haseventsource hasmodellingrule
           hasencoding hassubtype}
{rank=same alwaysgeneratesevent hasproperty}

}" />
</p>
<p>The ReferenceType hierarchy can be extended with user-defined ReferenceTypes.
Many Companion Specifications for OPC UA define new ReferenceTypes to be used
in their domain of interest.</p>
<p>For the following example of custom ReferenceTypes, we attempt to model the
structure of a technical system. For this, we introduce two custom
ReferenceTypes. First, the hierarchical <tt class="docutils literal"><span class="pre">contains</span></tt> ReferenceType indicates
that a system (represented by an OPC UA object) contains a component (or
subsystem). This gives rise to a tree-structure of containment relations. For
example, the motor (object) is contained in the car and the crankshaft is
contained in the motor. Second, the symmetric <tt class="docutils literal"><span class="pre">connectedTo</span></tt> ReferenceType
indicates that two components are connected. For example, the motor&#8217;s
crankshaft is connected to the gear box. Connections are independent of the
containment hierarchy and can induce a general graph-structure. Further
subtypes of <tt class="docutils literal"><span class="pre">connectedTo</span></tt> could be used to differentiate between physical,
electrical and information related connections. A client can then learn the
layout of a (physical) system represented in an OPC UA information model
based on a common understanding of just two custom reference types.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">UA_NODE_BASEATTRIBUTES</span>
    <span class="n">UA_Boolean</span> <span class="n">isAbstract</span><span class="p">;</span>
    <span class="n">UA_Boolean</span> <span class="n">symmetric</span><span class="p">;</span>
    <span class="n">UA_LocalizedText</span> <span class="n">inverseName</span><span class="p">;</span>
<span class="p">}</span> <span class="n">UA_ReferenceTypeNode</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="datatypenode">
<span id="id6"></span><h2>DataTypeNode<a class="headerlink" href="#datatypenode" title="Permalink to this headline">¶</a></h2>
<p>DataTypes represent simple and structured data types. DataTypes may contain
arrays. But they always describe the structure of a single instance. In
open62541, DataTypeNodes in the information model hierarchy are matched to
<tt class="docutils literal"><span class="pre">UA_DataType</span></tt> type descriptions for <a class="reference internal" href="types.html#generic-types"><em>Generic Type Handling</em></a> via their NodeId.</p>
<p>Abstract DataTypes (e.g. <tt class="docutils literal"><span class="pre">Number</span></tt>) cannot be the type of actual values.
They are used to constrain values to possible child DataTypes (e.g.
<tt class="docutils literal"><span class="pre">UInt32</span></tt>).</p>
<div class="highlight-c"><div class="highlight"><pre><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">UA_NODE_BASEATTRIBUTES</span>
    <span class="n">UA_Boolean</span> <span class="n">isAbstract</span><span class="p">;</span>
<span class="p">}</span> <span class="n">UA_DataTypeNode</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="viewnode">
<h2>ViewNode<a class="headerlink" href="#viewnode" title="Permalink to this headline">¶</a></h2>
<p>Each View defines a subset of the Nodes in the AddressSpace. Views can be
used when browsing an information model to focus on a subset of nodes and
references only. ViewNodes can be created and be interacted with. But their
use in the <a class="reference internal" href="services.html#view-services"><em>Browse</em></a> service is currently unsupported in
open62541.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">UA_NODE_BASEATTRIBUTES</span>
    <span class="n">UA_Byte</span> <span class="n">eventNotifier</span><span class="p">;</span>
    <span class="n">UA_Boolean</span> <span class="n">containsNoLoops</span><span class="p">;</span>
<span class="p">}</span> <span class="n">UA_ViewNode</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="nodestore-plugin-api">
<h1>Nodestore Plugin API<a class="headerlink" href="#nodestore-plugin-api" title="Permalink to this headline">¶</a></h1>
<p>The following definitions are used for implementing custom node storage
backends. <strong>Most users will want to use the default nodestore and don&#8217;t need
to work with the nodestore API</strong>.</p>
<p>Outside of custom nodestore implementations, users should not manually edit
nodes. Please use the OPC UA services for that. Otherwise, all consistency
checks are omitted. This can crash the application eventually.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cm">/* For non-multithreaded access, some nodestores allow that nodes are edited</span>
<span class="cm"> * without a copy/replace. This is not possible when the node is only an</span>
<span class="cm"> * intermediate representation and stored e.g. in a database backend. */</span>
<span class="k">extern</span> <span class="k">const</span> <span class="n">UA_Boolean</span> <span class="n">inPlaceEditAllowed</span><span class="p">;</span>

<span class="cm">/* Nodestore context and lifecycle */</span>
<span class="n">UA_StatusCode</span> <span class="nf">UA_Nodestore_new</span><span class="p">(</span><span class="kt">void</span> <span class="o">**</span><span class="n">nsCtx</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">UA_Nodestore_delete</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">nsCtx</span><span class="p">);</span>
</pre></div>
</div>
<p>The following definitions are used to create empty nodes of the different
node types. The memory is managed by the nodestore. Therefore, the node has
to be removed via a special deleteNode function. (If the new node is not
added to the nodestore.)</p>
<div class="highlight-c"><div class="highlight"><pre><span class="n">UA_Node</span> <span class="o">*</span>
<span class="nf">UA_Nodestore_newNode</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">nsCtx</span><span class="p">,</span> <span class="n">UA_NodeClass</span> <span class="n">nodeClass</span><span class="p">);</span>

<span class="kt">void</span>
<span class="nf">UA_Nodestore_deleteNode</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">nsCtx</span><span class="p">,</span> <span class="n">UA_Node</span> <span class="o">*</span><span class="n">node</span><span class="p">);</span>
</pre></div>
</div>
<p>pointer is no longer accessed afterwards.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="k">const</span> <span class="n">UA_Node</span> <span class="o">*</span>
<span class="nf">UA_Nodestore_getNode</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">nsCtx</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">nodeId</span><span class="p">);</span>

<span class="kt">void</span>
<span class="nf">UA_Nodestore_releaseNode</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">nsCtx</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_Node</span> <span class="o">*</span><span class="n">node</span><span class="p">);</span>

<span class="cm">/* Returns an editable copy of a node (needs to be deleted with the</span>
<span class="cm"> * deleteNode function or inserted / replaced into the nodestore). */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Nodestore_getNodeCopy</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">nsCtx</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">nodeId</span><span class="p">,</span>
                         <span class="n">UA_Node</span> <span class="o">**</span><span class="n">outNode</span><span class="p">);</span>

<span class="cm">/* Inserts a new node into the nodestore. If the NodeId is zero, then a fresh</span>
<span class="cm"> * numeric NodeId is assigned. If insertion fails, the node is deleted. */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Nodestore_insertNode</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">nsCtx</span><span class="p">,</span> <span class="n">UA_Node</span> <span class="o">*</span><span class="n">node</span><span class="p">,</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">addedNodeId</span><span class="p">);</span>

<span class="cm">/* To replace a node, get an editable copy of the node, edit and replace with</span>
<span class="cm"> * this function. If the node was already replaced since the copy was made,</span>
<span class="cm"> * UA_STATUSCODE_BADINTERNALERROR is returned. If the NodeId is not found,</span>
<span class="cm"> * UA_STATUSCODE_BADNODEIDUNKNOWN is returned. In both error cases, the editable</span>
<span class="cm"> * node is deleted. */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Nodestore_replaceNode</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">nsCtx</span><span class="p">,</span> <span class="n">UA_Node</span> <span class="o">*</span><span class="n">node</span><span class="p">);</span>

<span class="cm">/* Removes a node from the nodestore. */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Nodestore_removeNode</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">nsCtx</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">nodeId</span><span class="p">);</span>

<span class="cm">/* Execute a callback for every node in the nodestore. */</span>
<span class="k">typedef</span> <span class="nf">void</span> <span class="p">(</span><span class="o">*</span><span class="n">UA_NodestoreVisitor</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="n">visitorCtx</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_Node</span> <span class="o">*</span><span class="n">node</span><span class="p">);</span>
<span class="kt">void</span>
<span class="nf">UA_Nodestore_iterate</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">nsCtx</span><span class="p">,</span> <span class="n">UA_NodestoreVisitor</span> <span class="n">visitor</span><span class="p">,</span>
                     <span class="kt">void</span> <span class="o">*</span><span class="n">visitorCtx</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="node-handling">
<h1>Node Handling<a class="headerlink" href="#node-handling" title="Permalink to this headline">¶</a></h1>
<p>To be used only in the nodestore and internally in the SDK. The following
methods specialize internally for the different node classes, distinguished
by the NodeClass attribute.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cm">/* Attributes must be of a matching type (VariableAttributes, ObjectAttributes,</span>
<span class="cm"> * and so on). The attributes are copied. Note that the attributes structs do</span>
<span class="cm"> * not contain NodeId, NodeClass and BrowseName. The NodeClass of the node needs</span>
<span class="cm"> * to be correctly set before calling this method. UA_Node_deleteMembers is</span>
<span class="cm"> * called on the node when an error occurs internally. */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Node_setAttributes</span><span class="p">(</span><span class="n">UA_Node</span> <span class="o">*</span><span class="n">node</span><span class="p">,</span> <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">attributes</span><span class="p">,</span>
                      <span class="k">const</span> <span class="n">UA_DataType</span> <span class="o">*</span><span class="n">attributeType</span><span class="p">);</span>

<span class="cm">/* Reset the destination node and copy the content of the source */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Node_copy</span><span class="p">(</span><span class="k">const</span> <span class="n">UA_Node</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span> <span class="n">UA_Node</span> <span class="o">*</span><span class="n">dst</span><span class="p">);</span>

<span class="cm">/* Allocate new node and copy the values from src */</span>
<span class="n">UA_Node</span> <span class="o">*</span>
<span class="nf">UA_Node_copy_alloc</span><span class="p">(</span><span class="k">const</span> <span class="n">UA_Node</span> <span class="o">*</span><span class="n">src</span><span class="p">);</span>

<span class="cm">/* Add a single reference to the node */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Node_addReference</span><span class="p">(</span><span class="n">UA_Node</span> <span class="o">*</span><span class="n">node</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_AddReferencesItem</span> <span class="o">*</span><span class="n">item</span><span class="p">);</span>

<span class="cm">/* Delete a single reference from the node */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Node_deleteReference</span><span class="p">(</span><span class="n">UA_Node</span> <span class="o">*</span><span class="n">node</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_DeleteReferencesItem</span> <span class="o">*</span><span class="n">item</span><span class="p">);</span>

<span class="cm">/* Delete all references of the node */</span>
<span class="kt">void</span>
<span class="nf">UA_Node_deleteReferences</span><span class="p">(</span><span class="n">UA_Node</span> <span class="o">*</span><span class="n">node</span><span class="p">);</span>

<span class="cm">/* Remove all malloc&#39;ed members of the node */</span>
<span class="kt">void</span>
<span class="nf">UA_Node_deleteMembers</span><span class="p">(</span><span class="n">UA_Node</span> <span class="o">*</span><span class="n">node</span><span class="p">);</span>
</pre></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="server.html" class="btn btn-neutral float-right" title="Server" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="services.html" class="btn btn-neutral float-left" title="Services" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2016, The open62541 authors.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>